@using Glass.Mapper.Sc.Web.Mvc
@using Sitecore.Globalization
@using Sitecore.Mvc
@using Sitecore.Mvc.Configuration
@model DEWAXP.Feature.Bills.CollectiveStatement.CollectiveStatementModel

<div class="grid">
    @Html.Sitecore().Placeholder("j100/m26-page-title")

    @Html.Partial("~/Views/Feature/CommonComponents/Shared/_SubmissionError.cshtml")

    <div class="grid__row">
        <div class="grid__column grid__column--12 grid__column--form">
            <div class="text-block">
                @Html.Glass().Editable(x => x.Intro)
            </div>
        </div>
    </div>

    @using (Html.BeginRouteForm(MvcSettings.SitecoreRouteName, FormMethod.Post, new { @data_form = "true", @data_parsley_focus = "none", @class = "form", @data_submit_validate = "enabled", @novalidate = "true", encType = "multipart/form-data" }))
    {
        @Html.AntiForgeryToken()
        @Html.Sitecore().FormHandler()

        <div class="grid__row">
            @if (Model.AccountsList != null)
            {
                <div class="grid__column grid__column--12 grid__column--form">
                    <fieldset class="fieldset ">
                        <legend class="legend-color">.</legend>
                        <div class="form-field form-field--select form-field--select-single">
                            <label for="form-field-accounts" class="form-field__label">
                                @Translate.Text("Collective Account")
                            </label>
                            <span class="form-field__input-wrapper form-field__input-wrapper--select">
                                @Html.DropDownListFor(x => x.SelectedAccount, Model.AccountsList.ToList(),
                            Translate.Text("Collective Account Default"),
                            new
                            {
                                @class = "form-field__input form-field__input--select form-field__input--select-full",
                                @id = "form-field-accounts",
                                @aria_describedby = "description-for-accounts",
                                @required = "required",
                                @data_parsley_error_message = Translate.Text("Select from list"),
                                @data_parsley_errors_container = "#description-for-accounts",
                                @data_parsley_id = "22"
                            })
                            </span>
                            <div id="description-for-accounts" class="form-field__messages"></div>
                        </div>

                        <div class="form-field form-field--select form-field--select-single">
                            <label for="form-field-downloadoptions" class="form-field__label">
                                @Translate.Text("Download Options")
                            </label>
                            <span class="form-field__input-wrapper form-field__input-wrapper--select">
                                @Html.DropDownListFor(x => x.SelectedDownloadOption, Model.DownloadOptions.ToList(),
                            Sitecore.Globalization.Translate.Text("Download Option Default"),
                            new
                            {
                                @class = "form-field__input form-field__input--select form-field__input--select-full",
                                @id = "form-field-downloadoptions",
                                @aria_describedby = "description-for-downloadoptions",
                                @required = "required",
                                @data_parsley_error_message = Translate.Text("Select from list"),
                                @data_parsley_errors_container = "#description-for-downloadoptions",
                                @data_parsley_id = "22"
                            })
                            </span>
                            <div id="description-for-querytype" class="form-field__messages"></div>
                        </div>
                        <div>

                            @if (!String.IsNullOrWhiteSpace(Model.DownloadLink))
                            {
                                <a id="lnkDownload" href="@Model.DownloadLink" autofocus="" target="_blank" class="button button--text button--next">@Translate.Text("Click To Download")</a>
                            }
                        </div>
                    </fieldset>
                    <div class="form-field__button">
                        <button type="submit" class="button button--primary button--next" data-submission-text="@Translate.Text("Submitting")...">@Translate.Text("Submit")</button>
                    </div>
                </div>
            }
        </div>

    }
</div>

<script type="text/javascript">
    $(function () {
        document.getElementById('lnkDownload').focus();
    });

    $("#form-field-downloadoptions").change(function () {
        var selectedVal = $('option:selected', $(this)).val();
        $("#lnkDownload").hide();
        //alert($('option:selected', $(this)).val());
    });


</script>
@using Sitecore.Globalization
@using Sitecore.Mvc
@using Sitecore.Mvc.Configuration
@using DEWAXP.Foundation.Content
@model DEWAXP.Feature.Bills.Models.LandlordInformation.LandlordSupplyActivation

@Html.Partial("~/Views/Feature/CommonComponents/Shared/_SubmissionError.cshtml")

<div class="grid__row">
    <div class="grid__column grid__column--12 grid__column--form">
        @using (Html.BeginRouteForm(MvcSettings.SitecoreRouteName, FormMethod.Post, new { @class = "form", @id = "landlordsupplyactivation", @data_form = "true", @data_parsley_focus = "none", encType = "multipart/form-data", @data_submit_validate = "enabled" }))
        {
            @Html.Sitecore().FormHandler()
            @Html.AntiForgeryToken()

            <fieldset class="fieldset">
                <legend class="legend">@Translate.Text("Landlord Details")</legend>

                <div class="form-field form-field--select form-field--select-single">
                    <label for="form-field-businesspartner" class="form-field__label">
                        @Translate.Text("Landlord.Businesspartner")
                        <span class="form-field__label-required aria-only">(@Translate.Text("required"))</span>
                    </label>
                    <span class="form-field__input-wrapper form-field__input-wrapper--select">
                        @Html.DropDownListFor(x => x.SelectedBusinessPartnerNumber,
                            Model.BusinessPartnerNumberList,
                            Sitecore.Globalization.Translate.Text("Select from dropdown"),
                            new
                            {
                                @class = "form-field__input form-field__input--select form-field__input--select-full",
                                @id = "form-field-businesspartner",
                                aria_describedby = "description-for-bpSelected",
                                @required = "",
                                data_parsley_error_message = Translate.Text("Lanlord.bperrormessage"),
                                data_parsley_errors_container = "#description-for-bpSelected"
                            })
                    </span>
                    <div id="description-for-bpSelected" class="form-field__messages">
                        @Html.ValidationMessageFor(x => x.SelectedBusinessPartnerNumber, "", new { @class = "parsley-errors-list" })
                    </div>
                </div>

                <div class="form-field form-field--text ">
                    <label for="form-field-accountnumber" class="form-field__label">
                        @Translate.Text("Landloard.AccountNumber")
                        <span class="form-field__label-required aria-only">@Translate.Text("generic required label")</span>
                    </label>
                    <span class="form-field__input-wrapper">
                        <input class="form-field__input form-field__input--text"
                               id="form-field-accountnumber"
                               type="number" lang="en"
                               name="accountnumber"
                               placeholder="@Translate.Text("landlord.accountnumberplaceholder")"
                               value="@Model.AccountNumber"
                               aria-describedby="description-for-accountnumber"
                               required="required"
                               data-parsley-error-message="@Translate.Text("Landlord.accounterrormessage")"
                               data-parsley-errors-container="#description-for-accountnumber"
                               data-parsley-account_number="" />
                    </span>
                    <div id="description-for-accountnumber" class="form-field__messages">
                        @Html.ValidationMessageFor(x => x.AccountNumber, "", new { @class = "parsley-errors-list" })
                    </div>
                </div>

                <div class="form-field form-field--text ">
                    <label for="form-field-premisenumber" class="form-field__label">
                        @Translate.Text("Landlord.PremiseNumber")
                        <span class="form-field__label-required aria-only">@Translate.Text("generic required label")</span>
                    </label>
                    <span class="form-field__input-wrapper">
                        <input class="form-field__input form-field__input--text"
                               id="form-field-premisenumber"
                               type="number" lang="en"
                               name="PremiseNumber"
                               placeholder="@Translate.Text("Landlord.premiseerrorplaceholder")"
                               value="@Model.PremiseNumber"
                               aria-describedby="description-for-premisenumber"
                               required="required"
                               data-parsley-error-message="@Translate.Text("Landlord.premiseerrormessage")"
                               data-parsley-errors-container="#description-for-premisenumber"
                               data-parsley-premise_number="" />
                    </span>
                    <div id="description-for-premisenumber" class="form-field__messages">
                        @Html.ValidationMessageFor(x => x.PremiseNumber, "", new { @class = "parsley-errors-list" })
                    </div>
                </div>

                <div class="form-field form-field--select form-field--select-single">
                    <label for="form-field-nationality" class="form-field__label">@Translate.Text("Nationality") <span class="form-field__label-required aria-only">(@Translate.Text("required"))</span></label>
                    <label class="form-field__input-wrapper form-field__input-wrapper--select">
                        @Html.DropDownListFor(x => x.Nationality, (IEnumerable<SelectListItem>)ViewBag.Nationalities,
              Sitecore.Globalization.Translate.Text("Select from dropdown"),
              new
              {
                  @class = "form-field__input form-field__input--select form-field__input--select-full",
                  @id = "form-field-nationality",
                  @name = "select_optgropus",
                  @aria_describedby = "description-for-nationality",
                  @aria_required = "true",
                  @required = "",
                  @data_parsley_error_message = @Translate.Text("Landlord.nationalityerrormessage"),
                  @data_parsley_errors_container = "#description-for-nationality",
                  @data_parsley_id = "20"
              })
                    </label>
                    <div id="description-for-nationality" class="form-field__messages">
                        @Html.ValidationMessageFor(x => x.Nationality, "", new { @class = "parsley-errors-list" })
                    </div>
                </div>

                <div class="form-field form-field--text ">
                    <label for="form-field-mobile-number" class="form-field__label">
                        @Translate.Text("mobile number label")
                        <span class="form-field__label-required aria-only">@Translate.Text("generic required label")</span>
                    </label>
                    <span class="form-field__input-wrapper form-field__input-wrapper--prefixed form-field__input-wrapper--mobile-number">
                        <input class="form-field__input form-field__input--text form-field__input--prefixed"
                               type="number" lang="en"
                               id="form-field-mobile-number"
                               placeholder="@Translate.Text("Enter UAE mobile number")"
                               name="Mobile"
                               value="@Model.Mobile"
                               required="required"
                               aria-required="true"
                               aria-describedby="description-for-mobile"
                               data-parsley-error-message="@Translate.Text("uae mobile number validation message")"
                               data-parsley-errors-container="#description-for-mobile"
                               data-parsley-mobile_number="" />
                    </span>
                    <div id="description-for-mobile" class="form-field__messages">
                        @Html.ValidationMessageFor(x => x.Mobile, "", new { @class = "parsley-errors-list" })
                    </div>
                </div>

                <div class="form-field form-field--text ">
                    <label for="form-field-email" class="form-field__label">@Translate.Text("Email ID") <span class="form-field__label-required aria-only">(@Translate.Text("required"))</span></label>
                    <label class="form-field__input-wrapper">
                        @Html.TextBoxFor(x => x.Email,
                        new
                        {
                            @class = "form-field-email",
                            @id = "form-field-email",
                            @placeholder = Translate.Text("Enter email ID"),
                            @aria_required = "true",
                            @required = "",
                            @data_parsley_error_message = Translate.Text("Please enter a valid email address"),
                            @data_parsley_errors_container = "#description-for-email",
                            @aria_describedby = "description-for-email",
                            @data_parsley_id = "14",
                            @step = "any"
                        })
                    </label>
                    <div id="description-for-email" class="form-field__messages">
                        @Html.ValidationMessageFor(x => x.Email, "", new { @class = "parsley-errors-list" })
                    </div>
                </div>

            </fieldset>

            <div class="form-field__button">
                <button type="submit" class="button button--primary button--next">@Translate.Text("Submit")</button>
            </div>
        }
    </div>
</div>

<script type="text/javascript">
    docReady(function () {
        jQuery('#form-field-businesspartner').change(function () {
            var businesspartnerinput = $('#form-field-businesspartner option:selected').val();
            var url = "/api/BusinessPartnerDetails/Get";
            jQuery.ajax({
                url: url,
                traditional: true,
                data: {
                    id: businesspartnerinput,
                },
                dataType: 'json',
                type: 'GET',
            }).done(function (response) {
                if (response != null && response != "" && ((response.mobilenumber != "" && response.mobilenumber != undefined) || (response.email != "" && response.email != undefined))) {
                    jQuery('#form-field-mobile-number').val(response.mobilenumber);
                    jQuery('#form-field-email').val(response.email);
                    require(['parsley'], function () {
                        jQuery("#landlordsupplyactivation").parsley().validate();
                    });
                }
                else {
                    jQuery('#form-field-mobile-number').val("");
                    jQuery('#form-field-email').val("");
                }
            });
        });
    });
</script>
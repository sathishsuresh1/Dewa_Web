@using Sitecore.Globalization
@using Sitecore.Mvc
@using DEWAXP.Foundation.Helpers
@using DEWAXP.Foundation.Content
@model DEWAXP.Feature.GeneralServices.Models.ManageAlerts.Unsubscribe

@using (Html.BeginRouteForm(Sitecore.Mvc.Configuration.MvcSettings.SitecoreRouteName, FormMethod.Post, new { @class = "form", @data_form = "true", @data_parsley_focus = "none", @id = "unsubscribeform", @data_submit_validate = "enabled" }))
{
    @Html.AntiForgeryToken()
    @Html.Sitecore().FormHandler()
    @Html.Partial("~/Views/Feature/CommonComponents/Shared/_SubmissionError.cshtml")
    @*<form method="get" class="form" data-form="true" action="#" novalidate="">*@
    <div class="grid__row">
        <div class="grid__column grid__column--12 grid__column--form">
            @Html.Sitecore().Placeholder("unsubsribe title")
            <div class="form-field form-field--text ">
                <label for="form-field-email" class="form-field__label">
                    @Translate.Text("unsubscribe.emaillabel")
                    <span class="form-field__label-required aria-only">(@Translate.Text("required"))</span>
                </label>
                <span class="form-field__input-wrapper">
                    @Html.TextBoxFor(x => x.emailid,
                        new
                        {
                            @class = "form-field__input form-field__input--text",
                            @id = "form-field-email",
                            @name = "unsubscribe",
                            @type ="email",
                            @placeholder = Translate.Text("Type Email for unsubscription"),
                            @required = "",
                            @data_parsley_error_message = Translate.Text("Please enter a valid email address"),
                            @data_parsley_errors_container = "#description-for-wun2bjy3w",
                            @aria_describedby = "description-for-wun2bjy3w",
                            @data_parsley_id = "4",
                            @data_parsley_trigger = "focusout",
                            @step = "any"
                        })
                    @* <input class="form-field__input form-field__input--text" id="form-field-wun2bjy3w" name="unsubscribe" type="email" placeholder="Type Email for unsubscription" aria-describedby="description-for-wun2bjy3w" data-parsley-errors-container="#description-for-wun2bjy3w" required="" data-parsley-required-message="This field is required" data-parsley-trigger="focusout" data-parsley-id="4">*@
                </span>
                <div id="description-for-wun2bjy3w" class="form-field__messages">
                </div>
            </div>
            <div class="form-field form-field--select form-field--select-single">
                <label for="form-field-reason" class="form-field__label">
                    @Translate.Text("unsubscribe.reason")
                    <span class="form-field__label-required aria-only">(@Translate.Text("required"))</span>
                </label>
                <span class="form-field__input-wrapper form-field__input-wrapper--select">
                    @Html.DropDownListFor(x => x.selectedreason, (IEnumerable<SelectListItem>)ViewBag.Reasons,
         Sitecore.Globalization.Translate.Text(DictionaryKeys.Global.Forms.UnsubscribeReasonSelectionPlaceholder),
         new
         {
             @class = "form-field__input form-field__input--select form-field__input--select-full",
             @id = "form-field-reason",
             @aria_describedby = "description-for-reason",
             @data_parsley_error_message = Translate.Text("unsubscribe.reasonserrormessage"),
             @data_parsley_errors_container = "#description-for-reason",
             @data_parsley_id = "22",
             @required = "required"
         })
                </span>
                <div id="description-for-reason" class="form-field__messages"></div>
            </div>
            @if((bool)ViewBag.Recaptcha)
            {
                <br/>
            <div class="g-recaptcha" data-sitekey="@(ViewBag.SiteKey)"></div>
            }
            @*else
            {
            @Html.Captcha(Translate.Text("Unsubscribe-Refresh"), Translate.Text("Unsubscribe-Captcha"), 5, "Is required field", true)
            }*@
            @Html.Sitecore().Placeholder("unsubsribe description")
        </div>
    </div>
    <div class="grid__row">
        <div class="grid__column grid__column--12 grid__column--centered">
            <button id="subcribe-button" type="submit" class="button button--secondary button--next"  data-submission-text="@Translate.Text("Submitting")...">@Translate.Text("Unsubscribe")</button>
        </div>
    </div>
    @*</form>*@
}

<script type="text/javascript">
    docReady(function () {
        jQuery('a').each(function () {
            if (jQuery(this).attr('href') == '#CaptchaImage') {
                jQuery(this).attr('href', 'javascript:void(0);');
            }
        })
    });
</script>
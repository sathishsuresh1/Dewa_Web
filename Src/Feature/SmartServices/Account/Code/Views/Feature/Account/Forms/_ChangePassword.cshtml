@using Sitecore.Globalization
@using DEWAXP.Foundation.Helpers
@using Sitecore.Mvc
@using Sitecore.Mvc.Configuration
@model DEWAXP.Foundation.Content.Models.AccountModel.ChangePasswordModel

@if (ViewBag.ChangePassword == null)
{
    <div class="grid__row">
        <div class="grid__column grid__column--12 grid__column--form">
            <div class="m17-sectiontitle" data-component="m17-sectiontitle">
                <h3 class="m17-sectiontitle__title m17-sectiontitle__title--green text__section-title">
                    @Translate.Text("Change Password")
                </h3>
                <p class="m17-sectiontitle__text mb12">
                    @Translate.Text("change password intro text")
                </p>
            </div>
        </div>
    </div>
    <div class="grid__row">
        <div class="grid__column grid__column--12 grid__column--form">
            @using (Html.BeginRouteForm(MvcSettings.SitecoreRouteName, FormMethod.Post, new { @class = "form", @data_form = "true", @data_parsley_focus = "none", @data_submit_validate = "enabled", @autocomplete = "off" }))
            {
                @Html.Sitecore().FormHandler()
                @Html.AntiForgeryToken()
                @Html.Partial("~/Views/Feature/CommonComponents/Shared/_SubmissionError.cshtml")

                @Html.HiddenFor(m => m.UserId)
                <input name="TabId" type="hidden" class="TabId" />
                <fieldset class="fieldset">
                    <legend class="legend-color">.</legend>
                    <div class="form-field form-field--text">
                        <label for="form-field-oldpassword" class="form-field__label">
                            @Translate.Text("old password label")

                        </label>
                        <span class="form-field__input-wrapper">
                            @Html.TextBoxFor(x => x.OldPassword, new
                       {
                           @id = "form-field-oldpassword",
                           @class = "form-field__input form-field__input--text",
                           @placeholder = Translate.Text("old password label"),
                           @required = "required",
                           @type = "password",
                           @data_parsley_error_message = Translate.Text("Current password validation message"),
                           @data_parsley_errors_container = "#description-for-oldpassword",
                           @aria_describedby = "description-for-oldpassword",
                           @autocomplete = "off"
                       })
                        </span>
                        <div id="description-for-oldpassword" class="form-field__messages">
                            @Html.ValidationMessageFor(x => x.OldPassword, "", new { @class = "parsley-errors-list" })
                        </div>
                    </div>
                    <div class="form-field form-field--text">
                        <label for="form-field-newpassword" class="form-field__label">
                            @Translate.Text("new password label")

                        </label>
                        <span class="form-field__input-wrapper">
                            @Html.TextBoxFor(x => x.NewPassword, new
                       {
                           @class = "form-field__input form-field__input--text",
                           @id = "form-field-newpassword",
                           @placeholder = Translate.Text("new password label"),
                           @required = "required",
                           @type = "password",
                           @data_parsley_error_message = Translate.Text("login password validation message alphanumeric"),
                           @data_parsley_errors_container = "#description-for-newpassword",
                           @data_parsley_password = "",
                           @aria_describedby = "description-for-newpassword",
                           @autocomplete = "off"
                       })
                        </span>
                        <div id="description-for-newpassword" class="form-field__messages">
                            <p class="form-field__description">@Translate.Text("password description text")</p>
                            @Html.ValidationMessageFor(x => x.NewPassword, "", new { @class = "parsley-errors-list" })
                        </div>
                    </div>
                    <div class="form-field form-field--text">
                        <label for="form-field-confirm_password" class="form-field__label">
                            @Translate.Text("confirm password label")
                            <span class="form-field__label-required aria-only">@Translate.Text("generic required label")</span>
                        </label>
                        <span class="form-field__input-wrapper">
                            @Html.TextBoxFor(x => x.ConfirmPassword, new
                       {
                           @id = "form-field-confirm_password",
                           @class = "form-field__input form-field__input--text",
                           @placeholder = Translate.Text("confirm password label"),
                           @required = "required",
                           @type = "password",
                           @data_parsley_errors_container = "#description-for-confirm_password",
                           @aria_describedby = "description-for-confirm_password",
                           @data_parsley_error_message = Translate.Text("New password and confirmation mismatch error"),
                           @data_parsley_equalto = "#form-field-newpassword",
                           @autocomplete = "off"
                       })
                        </span>
                        <div id="description-for-confirm_password" class="form-field__messages">
                            @Html.ValidationMessageFor(x => x.ConfirmPassword, "", new { @class = "parsley-errors-list" })
                        </div>
                    </div>
                </fieldset>
                <div class="form-field__button">
                    <button class="button button--primary" type="submit" data-submission-text="@Translate.Text("Submitting")...">@Translate.Text("save text")</button>
                </div>
            }
        </div>
    </div>
    <script src="~/scripts/External/nml/form-submit-validate.js"></script>
}
else if (ViewBag.ChangePassword == "invalid")
{
    @Html.Partial("~/Views/Feature/Account/Forms/_CannotChangePassword.cshtml")
}
else if (ViewBag.ChangePassword == "success")
{
    @Html.Partial("~/Views/Feature/Account/Forms/_ChangePasswordSuccessful.cshtml")
}

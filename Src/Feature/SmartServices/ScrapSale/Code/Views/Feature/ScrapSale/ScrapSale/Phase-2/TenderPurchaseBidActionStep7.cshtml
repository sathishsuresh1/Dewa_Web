@using Sitecore.Globalization;
@using DEWAXP.Foundation.Integration.CustomerSmartSalesSvc
@using DEWAXP.Foundation.Helpers
@using DEWAXP.Foundation.Content
@model DEWAXP.Feature.ScrapSale.Models.ScrapSale.TenderBidingStep7Model
@{
    var src1 = Model.TenderOther_AttachmentFileBinary1 != null ? "data:image;base64," + Convert.ToBase64String(Model.TenderOther_AttachmentFileBinary1) : "/images/preview@2x.png";
    var srctxt1 = !string.IsNullOrWhiteSpace(Model.TenderOther_AttachmentFileName1) ? Model.TenderOther_AttachmentFileName1 : "";
}

<div class="grid">
    <div class="grid__row mb12">
        <div class="grid__column grid__column--12">
            <!-- m26-page-title-start -->
            <div class="m26-page-title ">
                <div class="m26-page-title__links">
                    <p class="m26-page-title__backlink">
                        <a href="@LinkHelper.GetItemUrl(SitecoreItemIdentifiers.SCRAPESALE_TENDER_PUCHASE_BIDITEM_STEP6)" class="button button--text button--back">@Translate.Text("Back")</a>
                    </p>
                </div>
                <h2 class="text__page-title">
                    @Translate.Text("SS_BD_Header") @Model.TenderNumber
                </h2>
                <p class="text-page__intro">
                    @if (Sitecore.Context.Language.CultureInfo.TextInfo.IsRightToLeft)
                    {
                        @Model.TenderARDescription
                    }
                    else
                    {
                        @Model.TenderEndDescription
                    }
                </p>
            </div>
            <!-- m26-page-title-end -->
        </div>
    </div>
    <div class="grid__row mb12">
        <div class="grid__column grid__column--12 grid__column--form">
            <div class="m38-step-tracker" data-component="m38-step-tracker" data-total-steps="7" data-current-step="7" data-labels='{"conjunction":"@Translate.Text("of")"}' data-hasInfo="false">
                <div class="m38-steptracker__info-wrapper">@Translate.Text("SS_BD_Step7")</div>
                <div class="m38-step-tracker__progressbar" data-m38-progressbar="true" role="progressbar" aria-valuetext="">
                </div>
            </div>
        </div>
    </div>
    <div class="grid__row mb12">
        <div class="grid__column grid__column--12 grid__column--form">
            @*<h3 class="text__section-title">Other Documents (Optional)</h3>
                <h3 class="text__section-subtitle">List of documents we accept to quickly process the application.</h3>*@
            @using (Html.BeginRouteForm(Sitecore.Mvc.Configuration.MvcSettings.SitecoreRouteName,
         FormMethod.Post, new
         {
             @class = "form",
             @id = "IdTenderbidActionStep7",
             data_form = "true",
             data_parsley_focus = "none",
             @data_submit_validate = "enabled",
             enctype = "multipart/form-data",
             @autocomplete = "off"
         }))
            {
                @Html.AntiForgeryToken()
                @Html.Partial("~/Views/Feature/CommonComponents/Shared/_SubmissionError.cshtml")
                <fieldset class="fieldset">
                    <legend class="legend">@Translate.Text("SS_BD_DocAttach")</legend>
                    <div class="form-field form-field--upload">
                        <div class="form-field__input-wrapper">
                            <div class="form-field__preview-wrapper">

                                <img src="@src1"
                                     data-src="/images/preview@2x.png"
                                     data-success="/images/preview@2x.png"
                                     class="form-field__preview"
                                     aria-hidden="true"
                                     role="presentation"
                                     alt="@srctxt1"
                                     data-uploader-image="TenderOther_AttachedDocument1">

                            </div>
                            <div class="form-field__uploader-details">
                                <label for="form-field-TenderOther_AttachedDocument1" class="form-field__label">
                                    <strong class="form-field__label-description"></strong>
                                </label>
                                <div>
                                    <label>
                                        <input class="form-field__input form-field__input--upload"
                                               id="form-field-TenderOther_AttachedDocument1"
                                               name="TenderOther_AttachedDocument1"
                                               type="file"
                                               aria-describedby="description-for-TenderOther_AttachedDocument1"
                                               data-parsley-errors-container="#description-for-TenderOther_AttachedDocument1"
                                               data-parsley-required-message="@Translate.Text("SS_BD_DocAttachReq")"
                                               data-uploader-field="TenderOther_AttachedDocument1"
                                               accept="image/x-png,,image/jpg,,image/jpeg,,image/bmp,,application/pdf" data-accepts='"jpg", "bmp","png","jpeg","pdf"' data-size="10048000">

                                        <span class="button button--primary button--next button--small focus-enabled" data-uploader-button="upload-choose">@Translate.Text("Choose")</span>


                                    </label>
                                </div>
                                <p class="form-field__input--upload-format-error-message" data-uploader-format-error="error-message">@Translate.Text("invalid file type validation message")</p>
                                <p class="form-field__input--upload-size-error-message" data-uploader-size-error="error-message">@Translate.Text("file too large validation message")</p>

                                <p class="form-field__input--upload-filename" data-uploader-filename="TenderOther_AttachedDocument1" @(!string.IsNullOrWhiteSpace(srctxt1) ? "style=display:block !important" : "")>@srctxt1</p>
                                <p><button class="button button--text button--remove hidden" data-removeindex="1" data-uploader-remove="TenderOther_AttachedDocument1" @(!string.IsNullOrWhiteSpace(srctxt1) ? "style=display:block !important" : "")>@Translate.Text("Remove")</button></p>
                                @Html.HiddenFor(m => m.TenderOther_AttachmentRemove1, new { id = "flagremove1" })
                            </div>

                        </div>

                        <div id="description-for-TenderOther_AttachedDocument1" class="form-field__messages">
                            <p class="form-field__description">@Translate.Text("SS_BD_FileUploaderNote")</p>
                        </div>
                    </div>
                </fieldset>

                <div class="form-field__button">
                    <button type="submit" class="button button--primary button--fullwidth-mobile" data-submission-text="@Translate.Text("Submitting")...">@Translate.Text("Submit")</button>
                </div>
            }
        </div>
    </div>
</div>
<script src="~/Scripts/External/nml/form-submit-validate.js"></script>
<script type="text/javascript">
    jQuery('.button--remove').each(function () {
        jQuery(this).off('click.remove').on('click.remove', function () {
            var $this = jQuery(this);

            setTimeout(function () {
                var $index = $this.attr('data-removeindex');
                if ($index == 1) {
                    jQuery("#flagremove1").val(true);
                }
                $this.closest('.form-field__input-wrapper').find('.form-field__input--upload').change();

            }, 100)
        });
    });
</script>
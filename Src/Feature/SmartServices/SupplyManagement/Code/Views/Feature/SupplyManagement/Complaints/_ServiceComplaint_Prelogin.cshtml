@using DEWAXP.Foundation.Content
@using DEWAXP.Feature.SupplyManagement.Models.Complaints
@using Glass.Mapper.Sc.Web.Mvc
@using Sitecore.Globalization
@using Sitecore.Mvc
@model ServiceComplaint
@*@{
	var page = (GenericPageWithIntro)ViewBag.Page;
}*@

<div class="grid">
	@Html.Sitecore().Placeholder("j22/m26-page-title")

	@using (Html.BeginForm("MakeServiceComplaint", "Complaints", FormMethod.Post, new { @class = "form", data_form = "true", data_parsley_focus = "none", enctype = "multipart/form-data", @data_submit_validate = "enabled" }))
	{
		@Html.AntiForgeryToken()

        <div class="grid__row ">
            <div class="grid__column grid__column--12 grid__column--form text__content-copy--small">
                @Html.Glass().Editable(x => x.Intro)
            </div>
        </div>
        <div class="grid__row">
            <div class="grid__column grid__column--12 grid__column--form">
                <form method="get" class="form" data-form="true" data-parsley-focus="none" action="">
                    <fieldset class="fieldset">
                        <legend class="legend-color">.</legend>
                        <div class="form-field form-field--text">
                            <label for="form-field-acc_number" class="form-field__label">
                                @Translate.Text(DictionaryKeys.Global.Account.ContractAccountNumber)
                                <span class="form-field__label-optional">(@Translate.Text("optional"))</span>
                            </label>
                            <span class="form-field__input-wrapper">


                                <input class="form-field__input form-field__input--text" id="form-field-acc_number"
                                       type="number" lang="en"
                                       placeholder="@Translate.Text("Please enter a valid 10 digit account number")"
                                       aria-describedby="description-for-accountno"
                                       data-parsley-error-message="@Translate.Text("Please enter a valid 10 digit account number")"
                                       data-parsley-errors-container="#description-for-accountno"
                                       data-parsley-account_number="" />
                            </span>
                            <div id="description-for-accountno" class="form-field__messages"></div>
                        </div>

                        <div class="form-field form-field--text ">
                            <label for="form-field-contactname" class="form-field__label">
                                @Translate.Text("Contact Name")<span class="form-field__label-required aria-only">(@Translate.Text("Required"))</span>
                            </label>
                            <span class="form-field__input-wrapper">
                                @Html.TextBoxFor(x => x.ContactName, new
                                   {
                                       @class = "form-field__input form-field__input--text",
                                       @id = "form-field-contactname",
                                       @placeholder = Translate.Text("Contact Name"),
                                       @required = "",
                                       @data_parsley_error_message = Translate.Text(DictionaryKeys.Complaints.EnterValidName),
                                       @data_parsley_errors_container = "#description-for-contactname",
                                       @aria_describedby = "description-for-contactname",
                                       @data_parsley_name="",
                                       @data_parsley_name_message = Translate.Text(DictionaryKeys.Complaints.EnterValidName),
                                       @data_parsley_maxlength="40"
                                   })
                            </span>
                            <div id="description-for-contactname" class="form-field__messages"></div>
                        </div>

                        <div class="form-field form-field--text ">
                            <label for="form-field-mobile" class="form-field__label">
                                @Translate.Text("Mobile number")
                                <span class="form-field__label-required aria-only">(@Translate.Text("Required"))</span>
                            </label>
                            <span class="form-field__input-wrapper form-field__input-wrapper--prefixed form-field__input-wrapper--mobile-number">
                                <input class="form-field__input form-field__input--text form-field__input--prefixed"
                                       id="form-field-mobile"
                                       name="MobileNumber"
                                       type="tel"
                                       placeholder="@Translate.Text("Enter UAE mobile number")"
                                       aria-describedby="description-for-mobile"
                                       required=""
                                       data-parsley-error-message="@Translate.Text("Please enter a valid UAE mobile number")"
                                       data-parsley-errors-container="#description-for-mobile"
                                       data-parsley-mobile_number=""
                                       data-parsley-type="digits" />
                            </span>
                            <div id="description-for-mobile" class="form-field__messages"></div>
                        </div>

                        <div class="form-field">
                            <div class="form-field__checkbox ">
                                <label for="form-field-location-coordinates">
                                    <input class="form-field__input form-field__input--checkbox" id="form-field-location-coordinates" name="LocationCoordinates" type="checkbox" value="false" aria-describedby="description-for-sendcoords">
                                    <span class="form-field__fakecheckbox focus-enabled">@Translate.Text("Send location coordinates")</span>
                                </label>
                            </div>
                            <div id="description-for-sendcoords" class="form-field__messages">
                            </div>
                            <input type="hidden" name="xGPS" value="" id="xgps" />
                            <input type="hidden" name="yGPS" value="" id="ygps" />
                        </div>

                        <div class="form-field form-field--select form-field--select-single">
                            <label for="form-field-complaint-type" class="form-field__label">
                                @Translate.Text("Complaint Type")
                                <span class="form-field__label-required aria-only">(@Translate.Text("Required"))</span>
                            </label>
                            <span class="form-field__input-wrapper form-field__input-wrapper--select">
                                @Html.DropDownListFor(x => x.ComplaintType, (IEnumerable<SelectListItem>)ViewBag.Complaints, Translate.Text("Select"), new { @aria_describedby = "description-for-complaint-type", @required = "", data_parsley_error_message = Translate.Text("Please enter a value"), data_parsley_errors_container = "#description-for-complaint-type", @class = "form-field__input form-field__input--select form-field__input--select-full", @id = "form-field-complaint-type" })
                            </span>
                            <div id="description-for-complaint-type" class="form-field__messages"></div>
                        </div>

                        <div class="form-field form-field--select form-field--select-single">
                            <label for="form-field-city" class="form-field__label">
                                @Translate.Text("City")
                                <span class="form-field__label-required aria-only">(@Translate.Text("Required"))</span>
                            </label>
                            <span class="form-field__input-wrapper form-field__input-wrapper--select">
                                @Html.DropDownListFor(x => x.City, (IEnumerable<SelectListItem>)ViewBag.Cities, Translate.Text("Select"), new { @aria_describedby = "description-for-city", @required = "", data_parsley_error_message = Translate.Text("Please enter a value"), data_parsley_errors_container = "#description-for-city", @class = "form-field__input form-field__input--select form-field__input--select-full", @id = "form-field-city" })
                            </span>
                            <div id="description-for-city" class="form-field__messages">
                            </div>
                        </div>

                        <div class="form-field form-field--text form-field--textarea">
                            <label for="form-field-desc" class="form-field__label">
                                @Translate.Text("Description")
                                <span class="form-field__label-required aria-only">(@Translate.Text("Required"))</span>
                            </label>
                            <span class="form-field__input-wrapper">
                                @Html.TextAreaFor(x => x.Description, new
                                   {
                                       @class = "form-field__input form-field__input--text form-field__input--textarea",
                                       @id = "form-field-desc",
                                       @maxlength = "250",
                                       @data_textarea = "desc",
                                       @placeholder = Translate.Text(DictionaryKeys.Global.EnterYourMessage),
                                       @required = "required",
                                       @data_parsley_error_message = Translate.Text(DictionaryKeys.Global.EnterDescription),
                                       @data_parsley_errors_container = "#description-for-desc",
                                       @aria_describedby = "description-for-desc"
                                   })
                            </span>
                            <div id="description-for-desc" class="form-field__messages">
                                <p class="form-field__charcount">@Translate.Text("Max") <span data-charcount="desc">0</span>/250 @Translate.Text("Characters")</p>
                            </div>
                        </div>

                        <div class="form-field form-field--upload">
                            <div class="form-field__input-wrapper">
                                <div class="form-field__preview-wrapper">
                                    <img src="/images/preview@2x.png" data-src="/images/preview@2x.png" class="form-field__preview" aria-hidden="true" role="presentation" alt="" data-uploader-image="attachment">
                                </div>
                                <div class="form-field__uploader-details">
                                    <label for="form-field-attachment" class="form-field__label">
                                        <strong class="form-field__label-description inline-block">@Translate.Text("Attachment")</strong>
                                        <span class="form-field__label-optional">(@Translate.Text("optional"))</span>
                                    </label>
                                    <div>
                                        <label>
                                            <input class="form-field__input form-field__input--upload"
                                                   id="form-field-attachment"
                                                   name="File"
                                                   type="file"
                                                   aria-describedby="description-for-attachment"
                                                   data-parsley-errors-container="#errors-for-attachment"
                                                   data-uploader-field="attachment"
                                                   accept="image/png,image/x-png,image/jpeg,image/jpg,image/bmp,image/gif,application/pdf,text/csv,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document"
                                                   data-parsley-id="22"
                                                   aria-invalid="false" />
                                            <span class="button button--primary button--next button--small focus-enabled">@Translate.Text("Choose")</span>
                                        </label>
                                    </div>
                                    <p class="form-field__input--upload-filename" data-uploader-filename="attachment"></p>
                                    <p><button class="button button--text button--remove hidden" data-uploader-remove="attachment">@Translate.Text("Remove")</button></p>
                                </div>
                            </div>
                            <div id="description-for-attachment" class="form-field__messages">
                                <div id="errors-for-attachment"></div>
                                <p class="form-field__description">
                                    @Translate.Text("Max Size Copy")
                                </p>
                            </div>
                        </div>
                    </fieldset>
					<div class="form-field__button">
						<button class="button button--primary button--next" type="submit" data-submission-text="@Translate.Text("Submitting")...">@Translate.Text("Submit")</button>
					</div>
				</form>
			</div>
		</div>
	}
</div>

<script src="~/scripts/External/nml/form-submit-validate.js"></script>

<script>
	docReady(function () {
		jQuery(function ($) {
			var coords;

			getLocation();

			function getLocation() {
				if (navigator.geolocation) {
					navigator.geolocation.getCurrentPosition(showPosition);
					$(document).click('.form-field__fakecheckbox', checkboxChangeHandler);
				}
			}

			function showPosition(position) {
				coords = position.coords;
				$("#ygps").val(position.coords.latitude);
				$("#xgps").val(position.coords.longitude);
			}

			function checkboxChangeHandler() {
				setTimeout(checkValue, 2000);
			}

			function checkValue() {
				var $this = jQuery("#form-field-location-coordinates");
				if ($this.is(":checked")) {
					$this.val("true");
				} else {
					$this.val("false");
				}
			}
		});
	});
</script>
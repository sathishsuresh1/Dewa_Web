@using DEWAXP.Foundation.Helpers
@using Glass.Mapper.Sc.Fields
@using Sitecore.Mvc
@using Sitecore.Mvc.Configuration
@using Sitecore.Globalization
@using X.PagedList.Mvc;
@using X.PagedList;
@using X.PagedList.Mvc.Common;
@using X.PagedList.Web.Common;
@using DEWAXP.Foundation.Content
@model DEWAXP.Feature.GatePass.Models.ePass.AccountListModel

@if (Model != null && Model.ITEMPagedList != null && Model.ITEMPagedList.Count > 0)
{
    foreach (var _POList in Model.ITEMPagedList)
    {
        <p class="form-field__radio form-field__radio--accselector">
            <label>
                <input class="form-field__input form-field__input--radio" id="form-field-radio_1_1" name="radios_group1" type="radio" value="1" aria-describedby="description-for-" data-parsley-errors-container="#description-for-" checked="" data-input="radio" data-parsley-multiple="radios_group1">
                <span class="form-field__fakeradio form-field__fakeradio--right focus-enabled">

                    <span class="m43-accountsel__account" data-acc-detail="wrapper">

                        <span class="m43-accountsel__header">
                            <span class="m43-accountsel__name" data-acc-detail="acc_name">
                                <span class="inline-block" dir="ltr" data-acc-detail="acc_namedesc">@_POList.projectdescription</span>
                            </span>
                            <span class="m43-accountsel__details">
                                <abbr title="Epass.Project #" style="text-decoration: none;">@Translate.Text("Epass.Project")</abbr>: <span dir="rtl" data-acc-detail="acc_number">@_POList.projectid</span><span class="aria-only"> | </span>
                            </span>
                            <span class="m43-accountsel__details">
                                @Translate.Text("Epass.Expirydate"): <span dir="rtl" data-acc-detail="acc_type">@_POList.plannedenddate</span><span class="aria-only"> | </span>
                            </span>
                            <input type="hidden" id="supplierid" value="@Model.supplierid" />
                            <input type="hidden" id="suppliername" value="@Model.suppliername" />
                        </span>
                    </span>
                </span>
            </label>
        </p>}
    <!-- m34-pagination-start -->

    <div id="myPager" class="centerpage">
        @if (Model.ITEMPagedList.PageCount > 1)
        {
            <div class="fix" id="pager" style="bottom:-10px;">
                <div class="m34-pagination__content">
                    <div id="pagerContent">
                        @Html.PagedListPager(Model.ITEMPagedList, page => Url.Action("DisplayPOList", new
                       {
                           pageNo = page,
                           search = string.Empty

                       }
                 ),

                new PagedListRenderOptions
                {
                    LiElementClasses = new string[] { "m34-pagination__page-list-item" },
                    //LinkToFirstPageFormat = "|<",
                    LinkToPreviousPageFormat = @Translate.Text("Epass.Prev"),
                    LinkToNextPageFormat = @Translate.Text("Epass.Next"),
                    //LinkToLastPageFormat = ">|",
                    MaximumPageNumbersToDisplay = 3,
                    DisplayEllipsesWhenNotShowingAllPageNumbers = false,
                    DisplayLinkToLastPage = PagedListDisplayMode.Never,
                    DisplayLinkToFirstPage = PagedListDisplayMode.Never,


                }
            )
                    </div>
                </div>
            </div>
        }
    </div>

    <div id="description-for-" class="form-field__messages">
    </div>

    <script type="text/javascript">
        var isclick;
        docReady(function () {
            $('#m49-list-filter--input').off().on('keypress', function (e) {
                if (e.keyCode == 13) {
                    var existingString = $("#m49-list-filter--input").val();
                    var url = "/api/sitecore/ePass/DisplayPOList?pageNo=1&search=" + existingString;
                    GetRecords(url);
                    return false;
                }
            });
            $('.m49-list-filter--button').off('click').on('click', function () {
                var existingString = $("#m49-list-filter--input").val();
                var url = "/api/sitecore/ePass/DisplayPOList?pageNo=1&search=" + existingString;
                GetRecords(url);
                return false;
            });
            $('#pagerContent a').on('click', function () {
                event.preventDefault();
                isclick = true;
                var existingString = $("#m49-list-filter--input").val();
                var url = this.href
                if (existingString != "") {
                    var url = "/api/sitecore/ePass/DisplayPOList?pageNo=1&search=" + existingString;
                }
                GetRecords(url);
                return false;
            });
            function GetRecords(_url) {
                if (_url != '' && _url != null) {
                    jQuery.ajax({
                        url: _url,
                        type: 'GET',
                        cache: false,
                        success: function (result) {
                            $(".polistContent").html(result);
                            $('.pager_update').click();
                            $('#polistContent').animate({
                                scrollTop: 0
                            }, 600);
                        }
                    });
                }
            }

        })
    </script>

}
else
{
    <div class="m49-no-matches">
        @Translate.Text("Epass.Nomatchfound")
    </div>
}
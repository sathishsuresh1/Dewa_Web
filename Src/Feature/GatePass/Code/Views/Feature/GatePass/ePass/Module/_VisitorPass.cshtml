@using DEWAXP.Foundation.Helpers
@using Glass.Mapper.Sc.Fields
@using Sitecore.Mvc
@using Sitecore.Mvc.Configuration
@using Sitecore.Globalization
@using DEWAXP.Feature.GatePass.Models.ePass
@using DEWAXP.Foundation.Content
@model DEWAXP.Feature.GatePass.Models.ePass.VisitorPassModel
@{
    var Nationalities = DEWAXP.Foundation.Helpers.Extensions.FormExtensions.GetSAPCountryList(Sitecore.Context.Language.CultureInfo.TextInfo.IsRightToLeft ? "ar" : "en", HttpContext.Current.Request.Headers["User-Agent"]);
    var GccCountries = EpassHelper.GetGccCountries().ToArray();
    var nowmax = DateHelper.DubaiNow().AddMonths(-1).AddDays(2);
    var FromToTime = EpassHelper.GetFromToTime();
    DateTime nowoneyear;
    var _visaExpiry = "";

    if (!string.IsNullOrWhiteSpace(Model.VisaNumberExpirydate))
    {
        //_visaExpiry = Model.VisaExpiry.Replace("January", "يناير").Replace("February", "فبراير").Replace("March", "مارس").Replace("April", "أبريل").Replace("May", "مايو").Replace("June", "يونيو").Replace("July", "يوليو").Replace("August", "أغسطس").Replace("September", "سبتمبر").Replace("October", "أكتوبر").Replace("November", "نوفمبر").Replace("December", "ديسمبر");
        _visaExpiry = Convert.ToString(Model.VisaNumberExpirydate).Replace("يناير", "January").Replace("فبراير", "February").Replace("مارس", "March").Replace("أبريل", "April").Replace("مايو", "May").Replace("يونيو", "June").Replace("يوليو", "July").Replace("أغسطس", "August").Replace("سبتمبر", "September").Replace("أكتوبر", "October").Replace("نوفمبر", "November").Replace("ديسمبر", "December");
    }
    if (!string.IsNullOrWhiteSpace(_visaExpiry) && Convert.ToDateTime(_visaExpiry).Ticks < DateHelper.DubaiNow().AddDays(30).Ticks)
    {
        nowoneyear = Convert.ToDateTime(_visaExpiry).AddMonths(-1);
    }
    else
    {
        nowoneyear = DateHelper.DubaiNow().AddMonths(-1).AddDays(30);
    }
}
<div class="j113-epass" data-journey="j113-epass" data-wid="@Model.WID" data-gid="@Model.GID">
    <div class="grid">
        @Html.Sitecore().Placeholder("pagetitle")
        @if (!string.IsNullOrWhiteSpace(Model.ReferenceNumber))
        {
            <div class="grid__row">
                <div class="grid__column grid__column--12 grid__column--content">
                    <div class="m40-status-message m40-status-message--success  icon icon-new-success-message " data-component="m40-status-message">
                        <div class="m40-status-message__title">
                            @Translate.Text("Epass.Submissionsuccess")
                        </div>
                        <div class="m14-richtext">
                            <p class="">
                                @Translate.Text("Epass.Referencenumber"): <strong>@Model.ReferenceNumber</strong>
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="grid__row">
                <div class="grid__column grid__column--12 grid__column--content grid__column--centered">
                    <div class="m14-richtext">
                        <h3>
                            @Translate.Text("Epass.Whatsnext")
                        </h3>
                        <br />
                    </div>
                </div>
            </div>

            <div class="grid__row">

                <div class="grid__column grid__column--12 grid__column--centered">
                    <a href="@LinkHelper.GetItemUrl(SitecoreItemIdentifiers.Epass_VisitorPass)" class="button button--next mb12">
                        @Translate.Text("Epass.Applyanotherpass")
                    </a>
                    <a href="@LinkHelper.GetItemUrl(SitecoreItemIdentifiers.EPASS_ADMINDASHBOARD)" class="button button--primary button--next mb12" style="margin: 0 25px 12px;">@Translate.Text("Epass.Gotodashboard")</a>
                </div>
            </div>
        }
        else
        {
            <div class="grid__row">
                <div class="grid__column grid__column--12 grid__column--form">
                    <div id="tracker">
                        @Html.Sitecore().Placeholder("j18/m38-step-tracker")
                    </div>
                </div>
            </div>
            <div class="grid__row">
                <div class="grid__column grid__column--12 grid__column--form">

                    @using (Html.BeginRouteForm(MvcSettings.SitecoreRouteName, FormMethod.Post, new { @class = "ePassForm form", @id = "visitorform", @data_form = "true", @enctype = "multipart/form-data", @data_submit_validate = "enabled" }))
                    {
                        @Html.AntiForgeryToken()
                        @Html.Partial("~/Views/Feature/CommonComponents/Shared/_SubmissionError.cshtml")

                        <fieldset class="fieldset form-section" id="f1">
                            <legend class="legend hidden">@Translate.Text("visitor.step")</legend>
                            <div class="form-field form-field--text  ">
                                <label for="form-field-Visitorname" class="form-field__label">
                                    @Translate.Text("Visitor_LblFullnameasEID")
                                    <span class="form-field__label-required aria-only">@Translate.Text("Visitor_Required")</span>
                                </label>
                                <span class="form-field__input-wrapper">
                                    <input maxlength="80"
                                           data-parsley-maxlength="80"
                                           value="@Model.Visitorname"
                                           @*data-parsley-pattern="/^[a-zA-Z ]*$/"*@
                                           class="form-field__input form-field__input--text"
                                           id="form-field-Visitorname"
                                           name="Visitorname"
                                           type="text"
                                           placeholder="@Translate.Text("Visitor_PH_Visitorname")"
                                           aria-describedby="description-for-Visitorname"
                                           data-parsley-errors-container="#description-for-Visitorname"
                                           required=""
                                           data-parsley-error-message="@Translate.Text("Visitor_RqMsgVisitorname")"
                                           data-parsley-trigger="focusout"
                                           data-parsley-id="30">
                                </span>
                                <div id="description-for-Visitorname" class="form-field__messages">
                                </div>
                            </div>

                            <div class="form-field form-field--text ">
                                <label for="form-field-VisitorEmailid" class="form-field__label">
                                    @Translate.Text("Visitor_lblVisitorEmailid")
                                </label>

                                <span class="form-field__input-wrapper">
                                    @Html.TextBoxFor(x => x.VisitorEmailid,
                                    new
                                    {
                                        @class = "form-field-EmailAddress form-field__input form-field__input--text",
                                        @id = "form-field-VisitorEmailid",
                                        @placeholder = Translate.Text("Visitor_PH_VisitorEmailid"),
                                        @data_parsley_error_message = Translate.Text("Epass.Entervalidemail"),
                                        @data_parsley_errors_container = "#description-for-visitoremailid",
                                        @aria_describedby = "description-for-VisitorEmailid",
                                        @data_parsley_id = "14",
                                        @step = "any",
                                        @type = "email",
                                        @required = "",
                                        @data_parsley_required_message = @Translate.Text("Visitor_RqMsgVisitorEmailid"),
                                        @maxlength = "50",
                                        @data_parsley_trigger = "focusout",
                                        @data_parsley_maxlength = "50"
                                    })

                                </span>
                                <div id="description-for-VisitorEmailid" class="form-field__messages">
                                    @Html.ValidationMessageFor(x => x.VisitorEmailid, "", new { @class = "parsley-errors-list" })
                                </div>
                            </div>

                            <div class="form-field form-field--text  ">
                                <label for="form-field-Projectname" class="form-field__label">
                                    @Translate.Text("Visitor_Projectname")
                                    <span class="form-field__label-required aria-only">@Translate.Text("Visitor_Required")</span>
                                </label>
                                <span class="form-field__input-wrapper">
                                    <input maxlength="100"
                                           data-parsley-maxlength="100"
                                           value="@Model.Projectname"
                                           class="form-field__input"
                                           id="form-field-Projectname"
                                           name="Projectname"
                                           type="text"
                                           placeholder="@Translate.Text("Visitor_PH_Projectname")"
                                           aria-describedby="description-for-Projectname"
                                           data-parsley-errors-container="#description-for-Projectname"
                                           required=""
                                           data-parsley-required-message="@Translate.Text("Visitor_RqMsgProjectname")"
                                           data-parsley-trigger="focusout"
                                           data-parsley-id="30">
                                </span>
                                <div id="description-for-Projectname" class="form-field__messages">
                                </div>
                            </div>


                            <div class="form-field form-field--text">
                                <label for="form-field-ProjectID" class="form-field__label">
                                    @Translate.Text("Visitor_lblProjectID")
                                    <span class="form-field__label-required aria-only">@Translate.Text("Visitor_Required")</span>
                                </label>
                                <span class="form-field__input-wrapper">
                                    <input maxlength="100"
                                           data-parsley-maxlength="100"
                                           value="@Model.ProjectID"
                                           class="form-field__input"
                                           id="form-field-ProjectID"
                                           name="ProjectID"
                                           type="text"
                                           placeholder="@Translate.Text("Visitor_PH_ProjectID")"
                                           aria-describedby="description-for-Projectname"
                                           data-parsley-errors-container="#description-for-ProjectID"
                                           required=""
                                           data-parsley-required-message="@Translate.Text("Visitor_RqMsgProjectID")"
                                           data-parsley-trigger="focusout"
                                           data-parsley-id="30">
                                </span>
                                <div id="description-for-ProjectID" class="form-field__messages">
                                </div>
                            </div>


                            <div class="form-field form-field--select form-field--select-single">
                                <label for="form-field-nationality" class="form-field__label">
                                    @Translate.Text("Visitor_lblNationality")
                                    <span class="form-field__label-required aria-only">@Translate.Text("Visitor_Required")</span>
                                </label>
                                <span class="form-field__input-wrapper form-field__input-wrapper--select">
                                    <select class="form-field__input form-field__input--select2 form-field__input--select form-field__input--select-full"
                                            id="form-field-nationality"
                                            name="Nationality"
                                            aria-describedby="description-for-nationality"
                                            data-parsley-errors-container="#description-for-nationality"
                                            required=""
                                            data-parsley-required-message="@Translate.Text("Visitor_RqMsgNationality")"
                                            data-parsley-trigger="change"
                                            data-parsley-id="32">
                                        <option value="" selected="">@Translate.Text("Visitor_Select")</option>

                                        @{
                                            foreach (var item in Nationalities)
                                            {

                                                if (!string.IsNullOrWhiteSpace(Model.Nationality) && item.Value == Model.Nationality)
                                                {
                                                    <option value="@item.Value" selected>@item.Text</option>
                                                }
                                                else
                                                {
                                                    <option value="@item.Value">@item.Text</option>
                                                }
                                            }
                                        }
                                    </select>
                                </span>
                                <div id="description-for-nationality" class="form-field__messages">
                                </div>
                            </div>

                            <div class="form-field form-field--text  ">
                                <label for="form-field-Designation" class="form-field__label">
                                    @Translate.Text("Visitor_lblDesignation")
                                    <span class="form-field__label-required aria-only">@Translate.Text("Visitor_Required")</span>
                                </label>
                                <span class="form-field__input-wrapper">
                                    <input maxlength="50"
                                           data-parsley-maxlength="50"
                                           value="@Model.Designation"
                                           class="form-field__input form-field__input--text"
                                           id="form-field-Designation"
                                           name="Designation"
                                           type="text"
                                           placeholder="@Translate.Text("Visitor_PH_Designation")"
                                           aria-describedby="description-for-Designation"
                                           data-parsley-errors-container="#description-for-Designation"
                                           required=""
                                           data-parsley-required-message="@Translate.Text("Visitor_RqMsg_Designation")"
                                           data-parsley-trigger="focusout"
                                           data-parsley-id="34">
                                </span>
                                <div id="description-for-Designation" class="form-field__messages">
                                </div>
                            </div>


                            <div class="form-field form-field--text ">
                                <label for="form-field-MobileNumber" class="form-field__label">
                                    @Translate.Text("Visitor_LblMobileNumber")
                                    <span class="form-field__label-required">(@Translate.Text("Epass.Optional"))</span>
                                </label>

                                <span class="form-field__input-wrapper form-field__input-wrapper--prefixed form-field__input-wrapper--mobile-number">
                                    @Html.TextBoxFor(x => x.MobileNumber,
                                    new
                                    {
                                    @type = "tel",
                                    @class = "form-field__input form-field__input--text form-field__input--prefixed",
                                    @id = "form-field-MobileNumber",
                                    @placeholder = Translate.Text("Visitor_PH_MobileNumber"),
                                    @data_parsley_error_message = Translate.Text("Visitor_RqMsg_MobileNumber"),
                                    @data_parsley_errors_container = "#description-for-MobileNumber",
                                    @aria_describedby = "description-for-MobileNumber",
                                    @data_parsley_id = "14",
                                    @data_parsley_type = "digits",
                                    @data_parsley_mobilenumber = "",
                                    @step = "any"
                                    })

                                </span>
                                <div id="description-for-MobileNumber" class="form-field__messages">
                                    @Html.ValidationMessageFor(x => x.MobileNumber, "", new { @class = "parsley-errors-list" })
                                </div>
                            </div>



                            @if (Model.LocationList != null)
                            {
                                <div class="form-field form-field--select form-field--select-single">
                                    <label for="form-field-Location" class="form-field__label">
                                        @Translate.Text("Visitor_LblLocation")
                                    </label>
                                    <span class="form-field__input-wrapper form-field__input-wrapper--select">
                                        <select class="form-field__input form-field__input--select form-field__input--select-full form-field__input--select2" id="form-field-Location" name="Location" multiple="multiple" aria-describedby="description-for-Location" data-parsley-errors-container="#description-for-Location"
                                                data-placeholder="@Translate.Text("Visitor_SelectLocation")"
                                                required data-parsley-required-message="@Translate.Text("Visitor_RqMsgLocation")">
                                            @{
                                                foreach (var item in Model.LocationList)
                                                {
                                                    <option value="@item.Value" @(Model.Location != null && Model.Location.Contains(item.Value) ? "selected" : string.Empty)>@Translate.Text(item.Text)</option>
                                                }
                                            }
                                        </select>
                                    </span>
                                    <div id="description-for-Location" class="form-field__messages">
                                    </div>
                                </div>
                            }
                        </fieldset>

                        <fieldset class="fieldset form-section" id="f2">
                            <legend class="legend hidden">
                                @Translate.Text("visitor.step")
                            </legend>
                            <div class="form-field form-field--text  ">
                                <label for="form-field-EmiratesID" class="form-field__label">
                                    @Translate.Text("Visitor_lblEmiratesID")
                                    <span class="form-field__label-required aria-only">@Translate.Text("Visitor_Required")</span>
                                </label>
                                <span class="form-field__input-wrapper">
                                    <input value="@Model.EmiratesID"
                                           class="form-field__input form-field__input--text form-field__binding"
                                           id="form-field-EmiratesID"
                                           name="EmiratesID"
                                           type="number"
                                           required=""
                                           data-parsley-required-message="@Translate.Text("Visitor_RqMsgEmiratesID")"
                                           placeholder="@Translate.Text("Visitor_PH_EmiratesID")"
                                           aria-describedby="description-for-EmiratesID"
                                           data-parsley-errors-container="#description-for-EmiratesID"
                                           data-parsley-emiratesid=""
                                           data-parsley-emiratesid-message="@Translate.Text("Visitor_ValidMsgEmiratesID")">
                                </span>
                                <div id="description-for-EmiratesID" class="form-field__messages">
                                    @Html.ValidationMessageFor(x => x.EmiratesID, "", new { @class = "parsley-errors-list" })
                                </div>
                            </div>

                            <div id="datepicker-container-EmiratesIDExpirydate" class="form-field form-field--text  ">
                                <label for="form-field-EmiratesIDExpiry" class="form-field__label">
                                    @Translate.Text("Visitor_LblEmiratesIDExpirydate")
                                    <span class="form-field__label-required aria-only">@Translate.Text("Visitor_Required")</span>
                                </label>
                                <span class="form-field__input-wrapper form-field__input-wrapper--datepicker">
                                    <input value="@Model.EmiratesIDExpirydate"
                                           class="form-field__input form-field__input--text   form-field__input--datepicker     picker__input form-field__binding"
                                           id="form-field-EmiratesIDExpiry"
                                           name="EmiratesIDExpirydate"
                                           type="text"
                                           placeholder="@Translate.Text("Visitor_PH_EmiratesIDExpirydate")"
                                           aria-describedby="description-for-EmiratesIDExpiry"
                                           data-parsley-errors-container="#description-for-EmiratesIDExpiry"
                                           @*data-parsley-error-message="@Translate.Text("Visitor_InvalidMsgEmiratesIDExpirydate")"*@
                                           data-el="datepicker-future"
                                           data-parsley-trigger="focusout"
                                           data-parsley-id="38"
                                           readonly=""
                                           required=""
                                           data-parsley-required-message="@Translate.Text("Visitor_RqMsgEmiratesIDExpirydate")"
                                           aria-haspopup="true"
                                           aria-expanded="false"
                                           aria-readonly="false"
                                           data-bindingID="emiratesidbinding"
                                           data-picker-options='{&quot;selectMonths&quot;: true , &quot;selectYears&quot;: 36 , &quot;format&quot;: &quot;yyyy/mm/dd&quot; , &quot;min&quot;: [@nowmax.Year,@nowmax.Month,@(nowmax.Day)]}'>
                                </span>
                                <div id="description-for-EmiratesIDExpiry" class="form-field__messages">
                                </div>
                            </div>

                            <div class="form-field form-field--text  ">
                                <label for="form-field-Passportnumber" class="form-field__label">
                                    @Translate.Text("Visitor_LblPassportnumber")
                                    <span class="form-field__label-required aria-only">@Translate.Text("Visitor_Required")</span>
                                </label>
                                <span class="form-field__input-wrapper">
                                    <input maxlength="15"
                                           data-parsley-maxlength="15"
                                           value="@Model.Passport"
                                           class="form-field__input form-field__input--text form-field__binding"
                                           id="form-field-Passportnumber"
                                           name="Passport"
                                           type="text"
                                           placeholder="@Translate.Text("Visitor_PH_Passportnumber")"
                                           aria-describedby="description-for-Passportnumber"
                                           data-parsley-errors-container="#description-for-Passportnumber"
                                           required=""
                                           data-bindingID="passportbinding"
                                           data-parsley-required-message="@Translate.Text("Visitor_RqMsgPassportnumber")"
                                           data-parsley-trigger="focusout"
                                           data-parsley-id="44">
                                </span>
                                <div id="description-for-Passportnumber" class="form-field__messages">
                                </div>
                            </div>

                            <div id="datepicker-container-Passportexpiry" class="form-field form-field--text  ">
                                <label for="form-field-Passportexpiry" class="form-field__label">
                                    @Translate.Text("Visitor_LblPassportexpirydate")
                                    <span class="form-field__label-required aria-only">@Translate.Text("Visitor_Required")</span>
                                </label>
                                <span class="form-field__input-wrapper form-field__input-wrapper--datepicker">
                                    <input value="@Model.PassportExpirydate"
                                           class="form-field__input form-field__input--text   form-field__input--datepicker     picker__input form-field__binding"
                                           id="form-field-Passportexpiry"
                                           name="PassportExpirydate"
                                           type="text"
                                           placeholder="@Translate.Text("Visitor_PH_Passportexpirydate")"
                                           aria-describedby="description-for-Passportexpiry"
                                           data-parsley-errors-container="#description-for-Passportexpiry"
                                           required=""
                                           data-parsley-required-message="@Translate.Text("Visitor_RqMsgPassportexpirydate")"
                                           data-el="datepicker-future"
                                           data-parsley-trigger="focusout"
                                           data-parsley-id="46"
                                           readonly=""
                                           data-bindingID="passportbinding"
                                           aria-haspopup="true"
                                           aria-expanded="false"
                                           aria-readonly="false"
                                           data-picker-options='{&quot;selectMonths&quot;: true , &quot;selectYears&quot;: 36 , &quot;format&quot;: &quot;yyyy/mm/dd&quot; , &quot;min&quot;: [@nowmax.Year,@nowmax.Month,@(nowmax.Day)]}'>
                                </span>
                                <div id="description-for-Passportexpiry" class="form-field__messages">
                                </div>
                            </div>

                            <div class="form-field form-field--text  ">
                                <label for="form-field-VisaNumber" class="form-field__label">
                                    @Translate.Text("Visitor_LblVisaNumber")
                                    <span class="form-field__label-required" id="spnVisanumber">(@Translate.Text("Visitor_Optional"))</span>
                                </label>
                                <span class="form-field__input-wrapper">
                                    <input maxlength="15" data-parsley-maxlength="15" value="@Model.VisaNumber"
                                           class="form-field__input form-field__input--text form-field__binding"
                                           id="form-field-VisaNumber" name="VisaNumber"
                                           type="number"
                                           placeholder=" @Translate.Text("Visitor_PH_VisaNumber")"
                                           aria-describedby="description-for-VisaNumber"
                                           data-parsley-errors-container="#description-for-visa"
                                           data-parsley-trigger="focusout"
                                           data-parsley-id="40"
                                           data-parsley-required-message="@Translate.Text("Visitor_RqMsgVisaNumber")"
                                           data-bindingID="visabinding"
                                           oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);">
                                </span>
                                <div id="description-for-VisaNumber" class="form-field__messages">
                                    <p class="form-field__description">@Translate.Text("Visitor_Slash")</p>
                                </div>
                            </div>

                            <div id="datepicker-container-visaexpiry" class="form-field form-field--text  ">
                                <label for="form-field-visaexpiry" class="form-field__label">
                                    @Translate.Text("Visitor_LblVisaexpirydate")
                                    <span class="form-field__label-required" id="spnVisaexpirydate">(@Translate.Text("Visitor_Optional"))</span>
                                </label>
                                <span class="form-field__input-wrapper form-field__input-wrapper--datepicker">
                                    <input value="@Model.VisaNumberExpirydate"
                                           class="form-field__input form-field__input--text  form-field__input--datepicker picker__input form-field__binding"
                                           id="form-field-visaexpiry"
                                           name="VisaNumberExpirydate"
                                           type="text"
                                           placeholder="@Translate.Text("Visitor_PH_Visaexpirydate")"
                                           aria-describedby="description-for-visaexpiry"
                                           data-parsley-errors-container="#description-for-visaexpiry"
                                           data-el="datepicker-future"
                                           data-parsley-trigger="focusout"
                                           data-parsley-id="42"
                                           readonly=""
                                           data-parsley-required-message="@Translate.Text("Visitor_RqMsgVisaexpirydate")"
                                           aria-haspopup="true"
                                           aria-expanded="false"
                                           aria-readonly="false"
                                           data-bindingID="visabinding"
                                           data-picker-options='{&quot;selectMonths&quot;: true , &quot;selectYears&quot;: 36 , &quot;format&quot;: &quot;yyyy/mm/dd&quot; , &quot;min&quot;: [@nowmax.Year,@nowmax.Month,@(nowmax.Day)]}'>
                                </span>
                                <div id="description-for-visaexpiry" class="form-field__messages">
                                </div>
                            </div>
                        </fieldset>
                        <fieldset class="fieldset form-section" id="f3">
                            <legend class="legend hidden">@Translate.Text("visitor.step")</legend>
                            <div class="form-field form-field--upload">
                                <div class="form-field__input-wrapper">
                                    <div class="form-field__preview-wrapper">
                                        <img src="/images/preview_pdf@2x.png" data-src="/images/preview_pdf@2x.png" data-success="/images/upload_success@2x.png" class="form-field__preview" aria-hidden="true" role="presentation" alt="" data-uploader-image="ApplicatePhoto_attachmentFile">
                                    </div>
                                    <div class="form-field__uploader-details">
                                        <label for="form-field-ApplicatePhoto_attachment" class="form-field__label">
                                            @Translate.Text("Visitor_lblApplicatePhoto_attachment")
                                            <span class="form-field__label-required aria-only">@Translate.Text("Visitor_Required")</span>
                                        </label>
                                        <div>
                                            <label>
                                                <input class="form-field__input form-field__input--upload"
                                                       id="form-field-ApplicatePhoto_attachment"
                                                       name="ApplicatePhoto_attachment"
                                                       type="file"
                                                       aria-describedby="description-for-applicantphoto"
                                                       data-parsley-errors-container="#description-for-applicantphoto"
                                                       required=""
                                                       data-parsley-required-message="@Translate.Text("Visitor_RqMsgApplicatePhoto")"
                                                       data-uploader-field="ApplicatePhoto_attachmentFile"
                                                       accept="image/*"
                                                       data-accepts='"jpg", ".bmp","png","jpeg"'
                                                       data-size="2048000"
                                                       data-parsley-trigger="focusout"
                                                       data-parsley-id="48">
                                                <span class="button button--primary  button--small focus-enabled"
                                                      data-uploader-button="upload-choose">@Translate.Text("Choose")</span>

                                                </label>
                                            </div>
                                            <p class="form-field__input--upload-format-error-message" data-uploader-format-error="error-message">@Translate.Text("Visitor_Uploadformat")</p>
                                            <p class="form-field__input--upload-size-error-message" data-uploader-size-error="error-message">@Translate.Text("Visitor_Uploadfilesize")</p>
                                            <p class="form-field__input--upload-filename" data-uploader-filename="ApplicatePhoto_attachmentFile"></p>

                                            <p>
                                                <button class="button button--text button--remove hidden" data-uploader-remove="ApplicatePhoto_attachmentFile">@Translate.Text("Remove")</button>
                                            </p>
                                        </div>
                                    </div>
                                    <div id="description-for-applicantphoto" class="form-field__messages">
                                        <p class="form-field__description">@Translate.Text("Visitor_Infodoc")</p>
                                        <p class="form-field__error red">
                                            @Html.ValidationMessageFor(x => x.ApplicatePhoto_attachment)
                                        </p>
                                    </div>
                                </div>
                                <div class="form-field form-field--upload">
                                    <div class="form-field__input-wrapper">
                                        <div class="form-field__preview-wrapper">
                                            <img src="/images/preview_pdf@2x.png" data-src="/images/preview_pdf@2x.png" data-success="/images/upload_success@2x.png" class="form-field__preview" aria-hidden="true" role="presentation" alt="" data-uploader-image="EmiratesIDCard_attachmentFile">
                                        </div>
                                        <div class="form-field__uploader-details">
                                            <label for="form-field-EmiratesIDCard_attachment" class="form-field__label">
                                                @Translate.Text("lblEmiratesIDCard_attachment")
                                                <span class="form-field__label-required aria-only">@Translate.Text("Visitor_Required")</span>
                                            </label>
                                            <div>
                                                <label>
                                                    <input class="form-field__input form-field__input--upload"
                                                           id="form-field-EmiratesIDCard_attachment"
                                                           name="EmiratesIDCard_attachment"
                                                           type="file"
                                                           required=""
                                                           data-parsley-required-message="@Translate.Text("Visitor_EmiratesIDCard_attachmentRequired")"
                                                           aria-describedby="description-for-EmiratesIDCard_attachment"
                                                           data-parsley-errors-container="#description-for-EmiratesIDCard_attachment"
                                                           data-uploader-field="EmiratesIDCard_attachmentFile"
                                                           accept="image/*"
                                                           data-accepts='"jpg", ".bmp","png","jpeg"'
                                                           data-size="2048000"
                                                           data-parsley-trigger="focusout"
                                                           data-parsley-id="50">
                                                    <span class="button button--primary  button--small focus-enabled"
                                                          data-uploader-button="upload-choose">@Translate.Text("Choose")</span>
                                                    </label>
                                                </div>
                                                <p class="form-field__input--upload-format-error-message" data-uploader-format-error="error-message">@Translate.Text("Visitor_Uploadformat")</p>
                                                <p class="form-field__input--upload-size-error-message" data-uploader-size-error="error-message">@Translate.Text("Visitor_Uploadfilesize")</p>
                                                <p class="form-field__input--upload-filename" data-uploader-filename="EmiratesIDCard_attachmentFile"></p>
                                                <p>
                                                    <button class="button button--text button--remove hidden" data-uploader-remove="EmiratesIDCard_attachmentFile">@Translate.Text("Remove")</button>
                                                </p>
                                            </div>
                                        </div>
                                        <div id="description-for-EmiratesIDCard_attachment" class="form-field__messages">
                                            <p class="form-field__description">@Translate.Text("Visitor_Infodoc")</p>
                                            <p class="form-field__error red">
                                                @Html.ValidationMessageFor(x => x.EmiratesIDCard_attachment)
                                            </p>
                                        </div>
                                    </div>

                                    <div class="form-field form-field--upload">
                                        <div class="form-field__input-wrapper">
                                            <div class="form-field__preview-wrapper">
                                                <img src="/images/preview_pdf@2x.png" data-src="/images/preview_pdf@2x.png" data-success="/images/upload_success@2x.png" class="form-field__preview" aria-hidden="true" role="presentation" alt="" data-uploader-image="PassportCard_attachmentFile">
                                            </div>
                                            <div class="form-field__uploader-details">
                                                <label for="form-field-PassportCard_attachment" class="form-field__label">
                                                    @Translate.Text("Visitor_lblPassportCard_attachment")
                                                    <span class="form-field__label-required aria-only">@Translate.Text("Visitor_PassportCard_attachmentRequired")</span>
                                                </label>
                                                <div>
                                                    <label>
                                                        <input class="form-field__input form-field__input--upload"
                                                               id="form-field-PassportCard_attachment"
                                                               name="PassportCard_attachment"
                                                               type="file"
                                                               aria-describedby="description-for-applicantphoto"
                                                               data-parsley-errors-container="#description-for-PassportCard_attachment"
                                                               required=""
                                                               data-parsley-required-message="@Translate.Text("Visitor_passportRequired")"
                                                               data-uploader-field="PassportCard_attachmentFile"
                                                               accept="image/*"
                                                               data-accepts='"jpg", ".bmp","png","jpeg"'
                                                               data-size="2048000"
                                                               data-parsley-trigger="focusout"
                                                               data-parsley-id="48">
                                                        <span class="button button--primary  button--small focus-enabled"
                                                              data-uploader-button="upload-choose">@Translate.Text("Choose")</span>

                                                        </label>
                                                    </div>
                                                    <p class="form-field__input--upload-format-error-message" data-uploader-format-error="error-message">@Translate.Text("Visitor_Uploadformat")</p>
                                                    <p class="form-field__input--upload-size-error-message" data-uploader-size-error="error-message">@Translate.Text("Visitor_Uploadfilesize")</p>
                                                    <p class="form-field__input--upload-filename" data-uploader-filename="PassportCard_attachmentFile"></p>

                                                    <p>
                                                        <button class="button button--text button--remove hidden" data-uploader-remove="PassportCard_attachmentFile">@Translate.Text("Remove")</button>
                                                    </p>
                                                </div>
                                            </div>
                                            <div id="description-for-PassportCard_attachment" class="form-field__messages">
                                                <p class="form-field__description">@Translate.Text("Visitor_Infodoc")</p>
                                                <p class="form-field__error red">
                                                    @Html.ValidationMessageFor(x => x.PassportCard_attachment)
                                                </p>
                                            </div>
                                        </div>

                                        <div class="form-field form-field--upload">
                                            <div class="form-field__input-wrapper">
                                                <div class="form-field__preview-wrapper">
                                                    <img src="/images/preview_pdf@2x.png" data-src="/images/preview_pdf@2x.png" data-success="/images/upload_success@2x.png" class="form-field__preview" aria-hidden="true" role="presentation" alt="" data-uploader-image="VisaNumberCard_attachmentFile">
                                                </div>
                                                <div class="form-field__uploader-details">
                                                    <label for="form-field-VisaNumberCard_attachment" class="form-field__label">
                                                        @Translate.Text("Visitor_lblVisaNumberCard_attachment")
                                                        <span class="form-field__label-required" id="spnVisaPage">(@Translate.Text("Epass.Optional"))</span>
                                                    </label>
                                                    <div>
                                                        <label>
                                                            <input class="form-field__input form-field__input--upload"
                                                                   id="form-field-VisaNumberCard_attachment"
                                                                   name="VisaNumberCard_attachment"
                                                                   type="file"
                                                                   data-parsley-required-message="@Translate.Text("Visitor_VisaNumberCard_attachmentRequired")"
                                                                   aria-describedby="description-for-VisaNumberCard_attachment"
                                                                   data-parsley-errors-container="#description-for-VisaNumberCard_attachment"
                                                                   data-uploader-field="VisaNumberCard_attachmentFile"
                                                                   accept="image/*"
                                                                   data-accepts='"jpg", ".bmp","png","jpeg"'
                                                                   data-size="2048000"
                                                                   data-parsley-trigger="focusout"
                                                                   data-parsley-id="48">
                                                            <span class="button button--primary  button--small focus-enabled"
                                                                  data-uploader-button="upload-choose">@Translate.Text("Choose")</span>

                                                            </label>
                                                        </div>
                                                        <p class="form-field__input--upload-format-error-message" data-uploader-format-error="error-message">@Translate.Text("Visitor_Uploadformat")</p>
                                                        <p class="form-field__input--upload-size-error-message" data-uploader-size-error="error-message">@Translate.Text("Visitor_Uploadfilesize")</p>
                                                        <p class="form-field__input--upload-filename" data-uploader-filename="VisaNumberCard_attachmentFile"></p>

                                                        <p>
                                                            <button class="button button--text button--remove hidden" data-uploader-remove="VisaNumberCard_attachmentFile">@Translate.Text("Remove")</button>
                                                        </p>
                                                    </div>
                                                </div>
                                                <div id="description-for-VisaNumberCard_attachment" class="form-field__messages">
                                                    <p class="form-field__description">@Translate.Text("Visitor_Infodoc")</p>
                                                    <p class="form-field__error red">
                                                        @Html.ValidationMessageFor(x => x.VisaNumberCard_attachment)
                                                    </p>
                                                </div>
                                            </div>



                                            @*<div class="form-field__button">
                                                    <button class="button button--primary" data-submission-text="@Translate.Text("Submitting")..." type="submit">@Translate.Text("Submit")</button>
                                                </div>*@
                                        </fieldset>
                                        <div class="form-navigation form-field__button">
                                            <button type="button" class="button button--tertiary previous">@Translate.Text("Previous")</button>
                                            <button type="button" class="button button--primary button--next next">@Translate.Text("Next") </button>
                                            <button type="submit" class="button button--primary button--next" data-submission-text="@Translate.Text("Submitting")...">@Translate.Text("Continue")</button>
                                            <span class="clearfix"></span>
                                        </div>
                                    }
                </div>
            </div>
        }

    </div>
</div>
<script type="text/javascript">
    docReady(function () {
        var total = 3;
        var current = 1;
        var txt = jQuery("#f1").find('legend').text();
        steptracker(total, current, txt);
        var $sections = jQuery('.form-section');

        function navigateTo(index) {
            var txt = $sections
                .hide()
                .eq(index).find('legend').text();
            steptracker(total, index + 1, txt);

            // Mark the current section with the class 'current'
            $sections
                .removeClass('current')
                .eq(index)
                .addClass('current');
            $sections
                .hide()
                .eq(index)
                .show();


            jQuery('.form-navigation .previous').toggle(index > 0);
            var atTheEnd = index >= $sections.length - 1;
            jQuery('.form-navigation .next').toggle(!atTheEnd);
            jQuery('.form-navigation [type=submit]').toggle(atTheEnd);
            if (atTheEnd) {

            }
            $('html, body').animate({
                scrollTop: $("#rs_area").offset().top
            }, 2000);
        }
        function steptracker(total, current, txt) {
            $('.m38-step-tracker').attr('data-total-steps', total);
            $('.m38-step-tracker').attr('data-current-step', current);
            $('.m38-step-tracker__progressbar').attr('aria-valuetext', txt);
            $('.m38-step-tracker').attr('data-hasInfo', "true");

            jQuery(window).trigger('reinit_m38');
        }
        function curIndex() {
            // Return the current index by looking at which section has the class 'current'
            return $sections.index($sections.filter('.current'));
        }

        // Previous button is easy, just go back
        jQuery('.form-navigation .previous').click(function (e) {
            e.preventDefault();

            navigateTo(curIndex() - 1);
        });

        // Next button goes forward if current block valida5tes
        jQuery('.form-navigation .next').click(function (e) {

            require(['parsley'], function () {
                jQuery('#visitorform').parsley().whenValidate({
                    group: 'block-' + curIndex()
                }).done(function () {
                    navigateTo(curIndex() + 1);
                });
            });


        });

        // Prepare sections by setting the `data-parsley-group` attribute to 'block-0', 'block-1', etc.
        $sections.each(function (index, section) {
            jQuery(section).find(':input').attr('data-parsley-group', 'block-' + index);
        });
        setTimeout(function () { navigateTo(0); }, 5000);
        // Start at the beginning

        jQuery('#form-field-nationality').on('change', function () {
            //alert(this.value);
            var isRequired = true;
            var CountryArray = @Html.Raw(Json.Encode(@GccCountries.ToArray()));
            for (i = 0; i < CountryArray.length; i++) {
                if ($(this).find("option:selected").val() == CountryArray[i].Value) {
                    isRequired = false;
                    break;
                }
            }
            if (isRequired) {
                $("#spnVisanumber").html("");
                $("#spnVisaexpirydate").html("");
                $("#spnVisaPage").html("");
                $("#form-field-VisaNumber, #form-field-visaexpiry").prop('required', true);
                $("#form-field-VisaNumberCard_attachment").prop('required', true);
            }
            else {
                $("#spnVisanumber").html("(@Translate.Text("Epass.Optional"))");
                $("#spnVisaexpirydate").html("(@Translate.Text("Epass.Optional"))");
                $("#spnVisaPage").html("(@Translate.Text("Epass.Optional"))");
                $("#form-field-VisaNumber, #form-field-visaexpiry").removeAttr('required');
                $("#form-field-VisaNumberCard_attachment").removeAttr('required');
            }
        });
    });
</script>
<script src="~/Scripts/External/nml/form-submit-validate.js"></script>
@using DEWAXP.Foundation.Helpers
@using Glass.Mapper.Sc.Fields
@using Sitecore.Mvc
@using Sitecore.Mvc.Configuration
@using Sitecore.Mvc.Presentation
@using Sitecore.Globalization
@using DEWAXP.Foundation.Helpers.Extensions
@using DEWAXP.Foundation.Content
@model DEWAXP.Feature.GatePass.Models.ePass.PermanentPass


@{ var lang = Sitecore.Context.Language.CultureInfo.TextInfo.IsRightToLeft ? "ar" : "en"; }

<style type="text/css">
    .my-error-msg {
        font-size: 1.0em;
        font-weight: 600;
        text-align: center;
    }
</style>
<div class="form hidden multiple mt24">
    <div class="j113-epass--permPass__form-page">
        <a href="/upload/sample_multipass_file_@(lang).csv" class="button button--text button--next" aria-describedby="download-">@Translate.Text("Epass.Downloadfile")</a>
        <div class="form-field form-field--upload">
            <div class="form-field__input-wrapper">
                <div class="form-field__preview-wrapper">
                    <img src="/images/preview_pdf@2x.png" data-src="/images/preview_pdf@2x.png" data-success="/images/upload_success@2x.png" class="form-field__preview" aria-hidden="true" role="presentation" alt="" data-uploader-image="applicantinfo">
                </div>
                <div class="form-field__uploader-details">
                    <label for="form-field-applicantinfo" class="form-field__label">
                        @Translate.Text("Epass.Applicantcsv")
                        <span class="form-field__label-required aria-only">
                            @Translate.Text("Epass.Required")
                        </span>
                    </label>
                    <div>
                        <label>
                            <input class="form-field__input form-field__input--upload"
                                   id="form-field-applicantinfo"
                                   name="GroupPass_Applicants" type="file"
                                   aria-describedby="description-for-applicantinfo"
                                   data-parsley-errors-container="#description-for-applicantinfo"
                                   required="" data-parsley-required-message="@Translate.Text("Epass.Uploadmultipassfile")"
                                   data-uploader-field="applicantinfo"
                                   accept=".csv"
                                   data-accepts='"csv"'
                                   data-size="2048000"
                                   data-parsley-trigger="focusout"
                                   data-parsley-id="48">
                            <span class="button button--primary  button--small focus-enabled" data-uploader-button="upload-choose">
                                @Translate.Text("Epass.Choose")
                            </span>
                        </label>
                    </div>
                    <p class="form-field__input--upload-format-error-message" data-uploader-format-error="error-message">
                        @Translate.Text("Epass.Uploadformat")
                    </p>
                    <p class="form-field__input--upload-size-error-message" data-uploader-size-error="error-message">
                        @Translate.Text("Epass.Uploadfilesize")
                    </p>
                    <p class="form-field__input--upload-filename" data-uploader-filename="applicantinfo"></p>
                    <p>
                        <button class="button button--text button--remove hidden" data-uploader-remove="applicantinfo">
                            @Translate.Text("Epass.Remove")
                        </button>
                    </p>
                </div>
            </div>
            <div id="description-for-applicantinfo" class="form-field__messages">
                <p class="form-field__description">@Translate.Text("Epass.Notecsv")</p>
                <p class="form-field__error red my-error-msg">
                    @Html.ValidationMessageFor(x => x.GroupPass_Applicants)
                    @if (!MvcHtmlString.IsNullOrEmpty(Html.ValidationMessageFor(x => x.GroupPass_Applicants)))
                    {
                        if (Model.errorlist != null)
                        {
                            <div class="m37-expander" data-component="m37-expander">
                                <button data-toggle="true" aria-haspopup="true" aria-expanded="false" class="m37-expander__trigger">
                                    @Translate.Text("Epass.Errorlist")
                                </button>
                                <div data-content="true" class="m37-expander__content">
                                    <div class="m42-keyvalue">
                                        <dl>
                                            @foreach (var error in Model.errorlist)
                                            {
                                                <dt class="m42-keyvalue__key m42-keyvalue__key--secondary">
                                                    @Translate.Text("Epass.Linenumber") : @error.LineNumber
                                                </dt>
                                                <dd class="m42-keyvalue__value m42-keyvalue__value--secondary">@error.ExceptionInfo.Message.After("InvalidOperationException with the message:")</dd>

                                            }
                                        </dl>
                                    </div>
                                </div>
                            </div>
                        }
                        if (Model.errorDuplicatelist != null)
                        {
                            <div class="m37-expander" data-component="m37-expander">
                                <button data-toggle="true" aria-haspopup="true" aria-expanded="false" class="m37-expander__trigger">
                                    @Translate.Text("Epass.Errorlist")
                                </button>
                                <div data-content="true" class="m37-expander__content">
                                    <div class="m42-keyvalue">
                                        <dl>
                                            @foreach (var error in Model.errorDuplicatelist)
                                            {
                                                <dt class="m42-keyvalue__key m42-keyvalue__key--secondary">
                                                    @Translate.Text("Epass.IndName") : @error.Name
                                                </dt>
                                                @*<dt class="m42-keyvalue__key m42-keyvalue__key--secondary">Emirates ID : @error.EmiratesID</dt>
                                                    <dt class="m42-keyvalue__key m42-keyvalue__key--secondary">Passport Number : @error.PassportNumber</dt>
                                                    <dt class="m42-keyvalue__key m42-keyvalue__key--secondary">Visa Number : @error.VisaNumber</dt>*@
                                                <dd class="m42-keyvalue__value m42-keyvalue__value--secondary">@error.Errormessage</dd>
                                            }
                                        </dl>
                                    </div>
                                </div>
                            </div>
                        }
                    }
                </p>
            </div>
        </div>
        <div class="form-field__button">
            <button class="button button--primary button--next" type="submit" data-submission-text="@Translate.Text("Epass.Updating")...">@Translate.Text("Epass.Continue")</button>
        </div>
    </div>
</div>

<script type="text/javascript">
    docReady(function () {
        const myParam = @Model.PageNo;//urlParams.get('page');
        setTimeout(function () {
            if (x == "3") {
                $("#form-field-radio_multiplePP").click();
            }
        },250);
    });
</script>

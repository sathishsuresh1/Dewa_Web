@using DEWAXP.Foundation.Helpers
@using Glass.Mapper.Sc.Fields
@using Sitecore.Mvc
@using Sitecore.Mvc.Configuration
@using Sitecore.Globalization
@using DEWAXP.Foundation.Content
@model DEWAXP.Feature.GatePass.Models.ePass.UserRegistration


<div class="j113-epass">
    <div class="grid">
        <div class="grid__row">
            <div class="grid__column grid__column--12 grid__column--form">
                @Html.Sitecore().Placeholder("contenttitle")
                @using (Html.BeginRouteForm(MvcSettings.SitecoreRouteName, FormMethod.Post, new { @data_parsley_focus = "true", @data_form = "true", @class = "form", @id = "userregistrationform", @data_submit_validate = "enabled", @novalidate = string.Empty, @autocomplete = "off" }))
                {
                    @Html.Sitecore().FormHandler()
                    @Html.AntiForgeryToken()
                    @Html.Partial("~/Views/Feature/CommonComponents/Shared/_SubmissionError.cshtml")

                    <fieldset class="fieldset">
                        <legend class="legend-color">.</legend>

                        <div class="form-field form-field--text">
                            <label for="form-field-companyname" class="form-field__label form-field__label--readonly">
                                @Translate.Text("Epass.Companyname")
                            </label>
                            <div class="form-field__input-wrapper form-field__input-wrapper--readonly">
                                @Html.TextBoxFor(x => x.CompanyName,
                                      new
                                      {
                                          @class = "form-field__input form-field__input--readonly",
                                          @readonly = "",
                                          @name = "companyname",
                                          @id = "form-field-companyname",
                                          @data_parsley_errors_container = "#description-for-companyname",
                                          @aria_describedby = "description-for-companyname",
                                          @data_parsley_trigger = "focusout"
                                      })
                            </div>
                            <div id="description-for-companyname" class="form-field__messages">
                                @Html.ValidationMessageFor(x => x.CompanyName, "", new { @class = "parsley-errors-list" })
                            </div>
                        </div>

                        <div class="form-field form-field--text">
                            <label for="form-field-vendorid" class="form-field__label form-field__label--readonly">
                                @Translate.Text("Epass.Vendoridacc")
                            </label>
                            <div class="form-field__input-wrapper form-field__input-wrapper--readonly">
                                @Html.TextBoxFor(x => x.VendorId,
                                      new
                                      {
                                          @class = "form-field__input form-field__input--readonly",
                                          @readonly = "",
                                          @name = "vendorid",
                                          @id = "form-field-vendorid",
                                          @data_parsley_errors_container = "#description-for-vendorid",
                                          @aria_describedby = "description-for-vendorid",
                                          @data_parsley_trigger = "focusout"
                                      })
                            </div>
                            <div id="description-for-vendorid" class="form-field__messages">
                                @Html.ValidationMessageFor(x => x.CompanyName, "", new { @class = "parsley-errors-list" })
                            </div>
                        </div>

                        <div class="form-field form-field--text " id="divfname">
                            <label for="form-field-fname" class="form-field__label">
                                @Translate.Text("Epass.Fullname")
                                <span class="form-field__label-required aria-only">(@Translate.Text("required"))</span>
                            </label>
                            <span class="form-field__input-wrapper">
                                @Html.TextBoxFor(x => x.Fullname,
                                      new
                                      {
                                          @class = "form-field__input form-field__input--text",
                                          @name = "first-name",
                                          @id = "form-field-fname",
                                          @placeholder = @Translate.Text("Epass.Enterfullname"),
                                          @required = "",
                                          @maxlength = "50",
                                          @data_parsley_error_message = @Translate.Text("Epass.Enterfullname"),
                                          @data_parsley_errors_container = "#description-for-fname",
                                          @aria_describedby = "description-for-fname",
                                          @data_parsley_id = "8",
                                          @step = "any",
                                          @data_parsley_pattern = "/^[أ-يa-zA-Z ]*$/",
                                            @data_parsley_required_message = @Translate.Text("Epass.Enterfullname"),
                                        @data_parsley_pattern_message = @Translate.Text("Epass.Enterfullname")
                                      })

                            </span>
                            <div id="description-for-fname" class="form-field__messages">
                                @Html.ValidationMessageFor(x => x.Fullname, "", new { @class = "parsley-errors-list" })
                            </div>
                        </div>

                        <div class="form-field form-field--text ">
                            <label for="form-field-EmailAddress" class="form-field__label">@Translate.Text("Epass.Emailaddress") <span class="form-field__label-required aria-only">(@Translate.Text("required"))</span></label>
                            <span class="form-field__input-wrapper">
                                @Html.TextBoxFor(x => x.Emailid,
                                    new
                                    {
                                        @class = "form-field-EmailAddress",
                                        @id = "form-field-EmailAddress",
                                        @placeholder = Translate.Text("Enter email ID"),
                                        @required = "",
                                        @data_parsley_error_message = Translate.Text("Epass.Entervalidemail"),
                                        @data_parsley_errors_container = "#description-for-EmailAddress",
                                        @aria_describedby = "description-for-EmailAddress",
                                        @data_parsley_id = "14",
                                        @step = "any",
                                        @data_parsley_email = "",
                                        @type = "email",
                                        @maxlength = "50"
                                    })

                            </span>
                            <div id="description-for-EmailAddress" class="form-field__messages">
                                @Html.ValidationMessageFor(x => x.Emailid, "", new { @class = "parsley-errors-list" })
                            </div>
                        </div>

                        <div class="form-field form-field--text ">
                            <label for="form-field-MobilePhone" class="form-field__label">@Translate.Text("movein.mobilenumber") <span class="form-field__label-required aria-only">(@Translate.Text("required"))</span></label>

                            <span class="form-field__input-wrapper form-field__input-wrapper--prefixed form-field__input-wrapper--mobile-number">
                                @Html.TextBoxFor(x => x.MobilePhone,
                                        new
                                        {
                                            @type = "tel",
                                            @class = "form-field__input form-field__input--text form-field__input--prefixed",
                                            @name = "MobilePhone",
                                            @id = "form-field-MobilePhone",
                                            @placeholder = Translate.Text("Enter UAE mobile number"),
                                            @required = "",
                                            @data_parsley_error_message = Translate.Text("Please enter a valid UAE mobile number"),
                                            @data_parsley_errors_container = "#description-for-MobilePhone",
                                            @aria_describedby = "description-for-MobilePhone",
                                            @data_parsley_id = "14",
                                            @data_parsley_type = "digits",
                                            @data_parsley_mobilenumber = "",
                                            @step = "any",
                                        })

                            </span>
                            <div id="description-for-MobilePhone" class="form-field__messages">
                                @Html.ValidationMessageFor(x => x.MobilePhone, "", new { @class = "parsley-errors-list" })
                            </div>
                        </div>

                        <div class="form-field form-field--text  ">
                            <label for="form-field-Username" class="form-field__label">
                                @Translate.Text("Epass.Username")
                                <span class="form-field__label-required aria-only">@Translate.Text("Epass.Required")</span>
                            </label>
                            <span class="form-field__input-wrapper">
                                @Html.TextBoxFor(x => x.Username,
                                        new
                                        {
                                            @class = "form-field__input form-field__input--text",
                                            @id = "form-field-Username",
                                            @placeholder = @Translate.Text("Epass.Entertheusername"),
                                            @required = "",
                                            @data_parsley_required_message = @Translate.Text("Epass.Entertheusername"),
                                            @data_parsley_errors_container = "#description-for-username",
                                            @aria_describedby = "description-for-username",
                                            @data_parsley_id = "14",
                                            @data_parsley_dewausername = "",
                                            @data_parsley_dewausername_message = @Translate.Text("Epass.Enterusernamechar"),
                                            @step = "any"
                                        })
                            </span>
                            <div id="description-for-Username" class="form-field__messages">
                                @Html.ValidationMessageFor(x => x.Username, "", new { @class = "parsley-errors-list" })
                            </div>
                        </div>

                        <div class="form-field form-field--text  ">
                            <label for="form-field-Password" class="form-field__label">
                                @Translate.Text("Epass.Password")
                                <span class="form-field__label-required aria-only">@Translate.Text("Epass.Required")</span>
                            </label>
                            <span class="form-field__input-wrapper">
                                @Html.TextBoxFor(x => x.Password, new
                           {
                               @class = "form-field__input form-field__input--text form-field__input parsley",
                               @id = "form-field-password",
                               @placeholder = Translate.Text("Epass.Enterpassword"),
                               @required = "",
                               @data_parsley_error_message = Translate.Text("epass.login password validation message alphanumeric"),
                               @data_parsley_errors_container = "#description-for-form-field-password",
                               @aria_describedby = "description-for-form-field-password",
                               @data_parsley_id = "8",
                               @minlength = "8",
                               @maxlength = "30",
                               @type = "password",
                               @autocomplete = "off"
                           })
                            </span>
                            <div id="description-for-Password" class="form-field__messages">
                                @Html.ValidationMessageFor(x => x.Password, "", new { @class = "parsley-errors-list" })
                            </div>
                        </div>

                        <div class="form-field form-field--text ">
                            <label class="form-field__label" for="form-field-confirm-password">
                                @Sitecore.Globalization.Translate.Text("Epass.ConfirmPassword")
                                <span class="form-field__label-required aria-only">(@(Translate.Text("required")))</span>
                            </label>
                            <span class="form-field__input-wrapper">
                                @Html.TextBoxFor(x => x.ConfirmationPassword, new
                           {
                               @class = "form-field__input form-field__input--text",
                               @id = "form-field-confirm-password",
                               @placeholder = Translate.Text("Epass.Confimpassword"),
                               @data_parsley_required_message = Translate.Text("epass.login password validation message alphanumeric"),
                               @data_parsley_maxlength_message = Translate.Text("epass.login password validation message alphanumeric"),
                               @data_parsley_minlength_message = Translate.Text("epass.login password validation message alphanumeric"),
                               @data_parsley_equalto_message = Translate.Text("Epass.Passwordmismatch"),
                               @data_parsley_errors_container = "#description-for-form-field-confirm-password",
                               @data_parsley_equalto = "#form-field-password",
                               @data_parsley_id = "8",
                               @data_parsley_minlength = "8",
                               @maxlength = "30",
                               @type = "password",
                               @required = "required",
                               @autocomplete = "off"
                           })
                            </span>
                            <div id="description-for-form-field-confirm-password" class="form-field__messages">
                                @Html.ValidationMessageFor(x => x.ConfirmationPassword, "", new { @class = "parsley-errors-list" })
                            </div>
                        </div>

                        <div class="mt12">
                            <div class="g-recaptcha" id="captcha" data-callback="recaptchaCallback" data-expired-callback="recaptchaCallback" data-sitekey="@ViewBag.SiteKey"></div>
                            <span id='errorContainer' class="parsley-errors-list"></span>
                        </div>
                    </fieldset>
                    <div class="form-field__button">
                        <button id="loginButton" type="submit" class="button button--primary button--submit" data-submission-text="@Translate.Text("Submitting")...">@Translate.Text("epassregister.submit")</button>
                    </div>

                }
            </div>
        </div>
    </div>
</div>
<script src="~/Scripts/External/nml/form-submit-validate.js"></script>
<script>
    docReady(function () {
        require(['parsley'], function () {
            jQuery('.button--submit').off('click.submit').on('click.submit', function (e) {

                    var captcha = recaptchaCallback();
                    if (!jQuery('#userregistrationform').parsley().validate() || !captcha) {
                        e.preventDefault();
                        return false;
                    }
                    else {
                        return true;
                    }
            });
        });

        //recaptcha callback function

    });
    function recaptchaCallback() {
        var v = grecaptcha.getResponse();
        if (v.length == 0) {
            jQuery('#errorContainer').text('@Translate.Text("FG_Capatcha_Valid")');
            return false;
        }
        else {
            jQuery('#errorContainer').text("");
            return true;
        }
    }

</script>

@using DEWAXP.Foundation.Helpers
@using Sitecore.Globalization
@using Sitecore.Mvc
@using Sitecore.Mvc.Configuration
@using DEWAXP.Foundation.Content
@model DEWAXP.Feature.DRRG.Models.EvaluatorRegistrationModel


<div class="j04-drrg-evaluator">
    <div class="grid">
        @Html.Sitecore().Placeholder("pagetitle")
        <div class="grid__row">
            <div class="grid__column grid__column--12 grid__column--form">
                @using (Html.BeginRouteForm(MvcSettings.SitecoreRouteName, FormMethod.Post, new { @data_form = "true", @id = "forgotpasswordform", @data_parsley_focus = "none", @class = "form", @data_submit_validate = "enabled" }))
                {
                    @Html.Sitecore().FormHandler()
                    @Html.AntiForgeryToken()
                    @Html.Partial("~/Views/Feature/CommonComponents/Shared/_SubmissionErrorV2.cshtml")

                    <fieldset class="fieldset">
                        <legend class="legend-color">.</legend>
                        <div class="form-field form-field--text">
                            <label for="form-field-FullName" class="form-field__label">
                                @Translate.Text("Full Name")
                            </label>
                            <span class="form-field__input-wrapper">
                                <input class="form-field__input form-field__input--text"
                                       id="form-field-FullName"
                                       name="Name"
                                       data-input="fullname"
                                       type="text"
                                       placeholder="@Translate.Text("DRRG.FullName.Placeholder")"
                                       aria-describedby="description-for-FullName"
                                       data-parsley-errors-container="#description-for-FullName"
                                       required=""
                                       value="@Model.Name"
                                       maxlength="100"
                                       data-parsley-maxlength="100"
                                       data-parsley-pattern="^([^-\s0-9!@@#$%^&*()_+=][^0-9!@@#$%^&*()_+=]*)$"
                                       data-parsley-required-message="This field is required"
                                       data-parsley-trigger="focusout"
                                       data-parsley-id="13">
                            </span>
                            <div id="description-for-FullName" class="form-field__messages">
                            </div>
                        </div>
                        <div class="form-field form-field--text">
                            <label for="form-field-UserEmail" class="form-field__label">
                                @Translate.Text("DRRG_Dewaemail")
                            </label>
                            <span class="form-field__input-wrapper">
                                <input class="form-field__input form-field__input--text"
                                       id="form-field-UserEmail"
                                       name="Username"
                                       type="email"
                                       placeholder="@Translate.Text("DRRG.EmailAddress.Placeholder")"
                                       aria-describedby="description-for-UserEmail"
                                       data-parsley-errors-container="#description-for-UserEmail"
                                       required=""
                                       maxlength="70"
                                       minlength="6"
                                       value="@Model.Username"
                                       data-parsley-maxlength="70"
                                       data-parsley-minlength="6"
                                       data-parsley-minlength-message="@Translate.Text("DRRG.E-mailAddress.MinLength.Msg")"
                                       data-parsley-maxlength-message="@Translate.Text("DRRG.EmailAddress.MaxLength.Msg")"
                                       data-parsley-required-message="This field is required"
                                       data-parsley-trigger="focusout"
                                       data-parsley-id="12">
                            </span>
                            <div id="description-for-UserEmail" class="form-field__messages">
                            </div>
                        </div>
                        @if (ViewBag.Recaptcha!= null &&  (bool)ViewBag.Recaptcha)
                        {
                            <div class="mt12">
                                <div class="g-recaptcha" id="captcha" data-callback="recaptchaCallback" data-expired-callback="recaptchaCallback" data-sitekey="@ViewBag.SiteKey"></div>
                                <span id='errorContainer' class="parsley-errors-list"></span>
                            </div>
                        }
                    </fieldset>
                    <div class="form-field__button">
                        <a class="button button--quaternary button-2-fit" href="@LinkHelper.GetItemUrl(SitecoreItemIdentifiers.DRRG__EVALUATOR_LOGIN)">@Translate.Text("Cancel")</a>
                        <button class="button button--primary button-2-fit" id="fgpwdbtn" type="submit" data-submission-text="@Translate.Text("Submitting")...">@Translate.Text("Submit")</button>
                    </div>
                }
            </div>
        </div>
    </div>
</div>
<script>
    docReady(function () {
        require(['parsley'], function () {
            jQuery('#fgpwdbtn').off('click.submit').on('click.submit', function (e) {
                var captcha = recaptchaCallback();
                if (!jQuery('#forgotpasswordform').parsley().validate() || !captcha) {
                    e.preventDefault();
                    return false;
                }
                else {
                    return true;
                }
            });
        });
    });
    function recaptchaCallback() {
        var v = grecaptcha.getResponse();
        if (v.length == 0) {
            jQuery('#errorContainer').text('@Translate.Text("FG_Capatcha_Valid")');
            return false;
        }
        else {
            jQuery('#errorContainer').text("");
            return true;
        }
    }
</script>
<script src="~/Scripts/External/nml/form-submit-validate.js"></script>
